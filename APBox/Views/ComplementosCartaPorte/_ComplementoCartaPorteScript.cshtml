   
<script>
    $(function () {


        ///SCRIPT MERCANCIAS PARA ACTIVAR DROPDOW Y RELLENAR LOS CAMPOS MERCANCIAS

        $(function () {
            $('#CMercancia').change(function () {
                var MercanciasClaveProd = $("#CMercancia").val();
                $("#ClaveProdServID").html("");
                $("#ClaveUnidadConcepto").html("");
                consultaMercancia(MercanciasClaveProd);
            });

            $("#confDelete").on('click', function () {
                let text = "¿seguro que deseas eliminarlo?";
                if (confirm(text) == false) {
                    window.location.href = "../Index";
                }
            });

            function consultaMercancia(Mercancias) {

                if (Mercancias != "") {
                    $.get("/ComplementosCartaPorte/DatosCatalogoMercancias", { IdMercancia: Mercancias }, function (data) {
                        if (data.length > 0) {
                            $.each(data, function (index, row) {
                                $("#Mercancias_Mercancia_ClaveProdServCP").val(row.ClaveProdServCP);
                                $("#Mercancias_Mercancia_Descripcion").val(row.Descripcion);
                                $("#Mercancias_Mercancia_Cantidad").val(row.Cantidad);
                                $("#Mercancias_Mercancia_ClavesUnidad").val(row.ClavesUnidad);
                                $("#Mercancias_Mercancia_Unidad").val(row.Unidad);
                                $("#Mercancias_Mercancia_Dimensiones").val(row.Dimensiones);
                                $("#Mercancias_Mercancia_PesoEnKg").val(row.PesoEnKg);
                                $("#Mercancias_Mercancia_ValorMercancia").val(row.ValorMercancia);
                                $("#Mercancias_Mercancia_Moneda").val(row.Moneda);
                                $("#Mercancias_Mercancia_ClaveMaterialPeligroso").val(row.ClaveMaterialPeligroso);
                                $("#Mercancias_Mercancia_DescripEmbalaje option:contains('" + row.DescripEmbalaje + "')").prop('selected', true);
                                $("#Mercancias_Mercancia_TipoEmbalaje_Id").val(row.TipoEmbalaje_Id);

                                //alert(row.Moneda);
                                //alert(row.DescripEmbalaje);
                                //alert(row.TipoEmbalaje_Id);

                                //Activa Campo Material peligroso siempre y cuando haya un valor en la claveMaterialPeligroso
                                checkMaterialPeligroso($("#Mercancias_Mercancia_ClaveMaterialPeligroso").val());
                                function checkMaterialPeligroso(claveMaterialPeligroso) {
                                    var materialPeligrosoCheckbox = $("#Mercancias_Mercancia_MaterialPeligrosos");

                                    if (claveMaterialPeligroso) {
                                        materialPeligrosoCheckbox.prop("checked", true);
                                        $(".ActivaCampoMatPeligroso").removeClass("hiddenDiv");
                                    } else {
                                        materialPeligrosoCheckbox.prop("checked", false);
                                        $(".ActivaCampoMatPeligroso").addClass("hiddenDiv");
                                    }
                                }


                            });

                        }
                    });
                }


            }


        });

        //ACTIVA CAMPO PARTE TRANSPORTE
        $('#TipoFiguraTransporte').change(function () {
            var TipoFiguraTransporte = $(this).val();

            if (TipoFiguraTransporte === "02" || TipoFiguraTransporte === "03") {

                $('#ActivaCampoPartesTransporte').show(200);
            } else { $('#ActivaCampoPartesTransporte').hide(200); }
        });
    });
        ///obtiene ubicaciones y genera un dropdow en la vista detalle mercancia
        function getMercancias(){
            /*$(".getMercancias").click(function () {*/
                var ubicacionesLength = $('.ubicacion').length;

                if (ubicacionesLength > 0) {
                    var listUbicacion = [];
                    var dataOrigen = $("#Mercancias_Mercancia_CantidadTransportada_IDOrigen");
                    var dataDestino = $("#Mercancias_Mercancia_CantidadTransportada_IDDestino");
                    var comparaCadena = "OR";
                    $(".ubicacion").each(function (index, element) {
                        var IDClaveUbicacion = $(element).find('#IdUbicacion').text().trim();
                        listUbicacion.push({ "text": IDClaveUbicacion, "value": IDClaveUbicacion });

                    });

                    $.ajax({
                        type: 'POST',
                        url: ' @Url.Action("FiltrarUbicaciones", "ComplementosCartaPorte")',
                        data: JSON.stringify({
                            ListUbicacionClave: listUbicacion
                        }),
                        // dataType: 'html',
                        contentType: "application/json; charset=utf-8",
                        success: function (data) {
                            dataOrigen.empty();
                            dataDestino.empty();
                            $.each(data, function (index, row) {

                                if (row.value.indexOf(comparaCadena) !== -1) {
                                    dataOrigen.append("<option value='" + row.value + "'>" + row.text + "</option>")
                                } else {
                                    dataDestino.append("<option value='" + row.value + "'>" + row.text + "</option>")
                                }
                            });
                            //$(".getMercancias").tab('show');
                        },
                        error: function (jqxhr, textStatus, error) {
                            alert("Error al generar dropdow ubicaciones");
                        }
                    });
                    return false;

                }
            /*});*/
        }


    $(function () {
        $('#TranspInternac').change(function () {
            let divDatosTransInter = document.querySelector('.divValidaTransInternc');
            if ($('#TranspInternac').prop('checked')) {
                divDatosTransInter.style.display = "inline";
                divDatosTransInter.style.visibility = 'visible';
                //$('.divValidaTransInternc').show(200);
                $('#EntradaSalidaMerc').prop('checked', true);

            } else {
                divDatosTransInter.style.visibility = 'hidden';
                divDatosTransInter.style.display = "none";
                //$('.divValidaTransInternc').hide(200);
                $('#EntradaSalidaMerc').prop('checked', false);
        }
        });

    });
    $(function () {
        $('#Mercancias_Mercancia_MaterialPeligrosos').change(function () {

            if ($('#Mercancias_Mercancia_MaterialPeligrosos').prop('checked')) {
                $('.ActivaCampoMatPeligroso').show(200);
                $('#Mercancias_Mercancia_MaterialPeligrosos').val(true);
            } else {
                $('.ActivaCampoMatPeligroso').hide(200);
                $('#Mercancias_Mercancia_MaterialPeligrosos').val(false);
            }
        });

    });
    //checkbox activa pedimento,guias identificacion ,cantidad transportada  y detalle mercancia
    $(function () {
    $('.addPedimento').change(function () {
        if ($('.addPedimento').prop('checked')) {
            $('.DivPedimento').show(200);
            //$('.DivPedimento').css('display', 'inline');
        } else {
            $('.DivPedimento').hide(200);
        }
    });

        $('.addGIdentificacion').change(function () {
            if ($('.addGIdentificacion').prop('checked')) {
                $('.GuiasIdentificacionForm').show(200);
                //$('.GuiasIdentificacionForm').css('display', 'inline');
            } else {
                $('.GuiasIdentificacionForm').hide(200);
            }
        });


        $('.addCTransportada').change(function () {
            getMercancias();
            if ($('.addCTransportada').prop('checked')) {
                $('.DivCantidadTransportada').show(200);
                //$('.DivCantidadTransportada').css('display', 'inline');
            } else {
                $('.DivCantidadTransportada').hide(200);
            }
        });

        $('.addDMercancia').change(function () {
            if ($('.addDMercancia').prop('checked')) {
                $('.DivDetalleMercancia').show(200);
                //$('.DivDetalleMercancia').css('display', 'inline');
            } else {
                $('.DivDetalleMercancia').hide(200);
            }
        });

    });
    //ACTIVA CAMPOS CON TRANSPORTE INTERNACIONAL Y COMPROBANTE INGRESO
    $(function () {
        $('.ActivaCheckTransInter').change(function () {
            var ClaveTransporteId = $('#claveTransporteId').val();


            if ($('#TranspInternac').prop('checked') && (ClaveTransporteId === "01" || ClaveTransporteId ==="03")) {
                //$('.DivPedimento').show(200);

                $('.activaFraccionArancelaria').show();
                //$('.DivCantidadTransportada').show(200);


            } else {
                //$('.DivPedimento').hide(200);
                $('.activaFraccionArancelaria').hide(200);
                //$('.DivCantidadTransportada').hide(200);

            }
        });


    });

    $(function () {
        $('#claveTransporteId').change(function () {
            var ClaveTransporteId = $('#claveTransporteId').val();

            if (ClaveTransporteId === "01" || ClaveTransporteId === "03") {
                if ($('#TranspInternac').prop('checked')) {
                    //$('.DivPedimento').show(200);
                    $('.activaFraccionArancelaria').show(200);
                   // $('.DivCantidadTransportada').show(200);

                } else {
                    //$('.DivPedimento').hide(200);
                    $('.activaFraccionArancelaria').hide(200);
                    //$('.DivCantidadTransportada').hide(200);

                }
            }
        });


    });


    $(function () {
        //Agrega total peso tara mercancia
        $('#pesoNeto').on("keyup", function () {
            if ($('#pesoNeto').val() > 0 && $('#pesoBruto').val() > 0) {
                var pesoNeto = parseFloat($('#pesoNeto').val());
                var pesoBruto = parseFloat($('#pesoBruto').val());
                var Total;
                if ($('#pesoNeto').val() === "") { pesoNeto = 0; }
                if ($('#pesoBruto').val() === "") { pesoBruto = 0; }
                Total = pesoBruto - pesoNeto;
                $('#pesoTara').val(Total);
            } else {
                $('#pesoTara').val(0);
            }
        });
        $('#pesoBruto').on("keyup", function () {
            if ($('#pesoBruto').val() > 0 && $('#pesoNeto').val() > 0) {
                var pesoNeto = parseFloat($('#pesoNeto').val());
                var pesoBruto = parseFloat($('#pesoBruto').val());
                var Total;
                if ($('#pesoNeto').val() === "") { pesoNeto = 0; }
                if ($('#pesoBruto').val() === "") { pesoBruto = 0; }
                Total = pesoBruto - pesoNeto;

                $('#pesoTara').val(Total);
            } else {
                $('#pesoTara').val(0);
            }
        });
    });
    //DETALLE MERCANCIA
    $(function () {
        $('#agregarDetalleMercancia').click(function () {
            var contador = $(".mercancia").length + 1;
        $(".contadorMercancias").replaceWith('<span class="contadorMercancias font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleMercancia").on('click', function () {
        var CPSI = false;
        var D = false;
        var C = false;
        var CUI = false;
        var PKG = false;
        var CTC = true;
        var CTCTI = true;
        var CTCO = true;
        var CTCD = true;
        var message;


            //pedimento
            var jsonPedimentos = [];
            $(".Pedimentos").each(function (index, element) {

                var Pedimento = $(element).find('#Pedimento').text().trim();

                jsonPedimentos.push({
                    "Pedimento": Pedimento
                });
            });
            //Guia identificacion
            var jsonGIdentificacion = [];

            $(".GIdentificacion").each(function (index, element) {

                var NumGuiaIdentificacion = $(element).find('#NumGuiaIdentificacion').text().trim();
                var DescripGuiaIdentificacion = $(element).find('#DescripGuiaIdentificacion').text().trim();
                var PesoGuiaIdentificacion = $(element).find('#PesoGuiaIdentificacion').text().trim();

                jsonGIdentificacion.push({
                    "NumeroGuiaIdentificacion": NumGuiaIdentificacion, "DescripGuiaIdentificacion": DescripGuiaIdentificacion, "PesoGuiaIdentificacion": PesoGuiaIdentificacion
                });
            });
            //Cantidad transportada
            var jsonCTransportadas = [];

            $(".CTransportadas").each(function (index, element) {

                var Cantidad = $(element).find('#Cantidad').text().trim();
                var CveTransporte = $(element).find('#CveTransporte').text().trim();
                var IDOrigen = $(element).find('#IDOrigen').text().trim();
                var IDDestino = $(element).find('#IDDestino').text().trim();

                jsonCTransportadas.push({
                    "Cantidad": Cantidad, "CveTransporte_Id": CveTransporte, "IDOrigen": IDOrigen, "IDDestino": IDDestino
                });
            });

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarMercancia", "AjaxOperaciones")',
                data: JSON.stringify({
                    ClaveProdServID: $('#Mercancias_Mercancia_ClaveProdServCP').val(),//option:selected
                    ClaveProdSTCCID: $('#Mercancias_Mercancia_ClaveProdSTCC').val(),//option:selected
                    Descripcion: $('#Mercancias_Mercancia_Descripcion').val(),
                    Cantidad: $('#Mercancias_Mercancia_Cantidad').val(),
                    Unidad: $('#Mercancias_Mercancia_Unidad').val(),
                    ClaveUnidadID: $('#Mercancias_Mercancia_ClavesUnidad').val(),
                    Dimensiones: $('#Mercancias_Mercancia_Dimensiones').val(),
                    MaterialPeligorosoSN: $('#Mercancias_Mercancia_MaterialPeligrosos').val(),
                    MaterialPeligrosoID: $('#Mercancias_Mercancia_ClaveMaterialPeligroso').val(),
                    DescripcionEmbalaje: $('#Mercancias_Mercancia_DescripEmbalaje option:selected').text(),
                    TipoEmbalajeID: $('#Mercancias_Mercancia_TipoEmbalaje_Id').val(),
                    PesoEnKg: $('#Mercancias_Mercancia_PesoEnKg').val(),
                    ValorMercancia: $('#Mercancias_Mercancia_ValorMercancia').val(),
                    Moneda: $('#Mercancias_Mercancia_Moneda').val(),
                    FraccionArancelariaID: $('#Mercancias_Mercancia_FraccionArancelarias').val(),
                    UUIDComercioExt: $('#Mercancias_Mercancia_UUIDComecioExt').val(),
                    DEClaveUnidadPesoID: $('#Mercancias_Mercancia_DetalleMercancia_ClaveUnidadPeso_Id').val(),//option:selected
                    DEPesoBruto: $('#pesoBruto').val(),
                    DEPEsoNeto: $('#pesoNeto').val(),
                    DEPesoTara: $('#pesoTara').val(),
                    DENumPiezas: $('#Mercancias_Mercancia_DetalleMercancia_NumPiezas').val(),
                    PedimentoArray: jsonPedimentos,
                    GIdentificacionArray: jsonGIdentificacion,
                    CTransportadaArray: jsonCTransportadas,
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesMercancias').append(partialView);
                    var totalMercancia = $(".mercancia").length;
                    $("#Mercancias_NumTotalMercancias").val(totalMercancia);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
              });
            return false;

        });
    });

    function removeDetalleMercancia(elem) {
        var totalU = $(".mercancia").length;
        if (totalU > 0) {
            var contador = $(".mercancia").length - 1;
            $(".contadorMercancias").replaceWith('<span class="contadorMercancias font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorMercancias").replaceWith('<span class="contadorMercancias font-blue">');
        }
        $(elem).parent().parent().parent().remove();
        var totalMercancia = $(".mercancia").length;
        $("#Mercancias_NumTotalMercancias").val(totalMercancia);
    }

    //DETALLE MERCANCIAS EDITAR
     $(function () {
         $('#agregarDetalleMercanciaEdit').click(function () {
             var contador = $(".mercanciaEdit").length + 1;
        $(".contadorMercanciasEdit").replaceWith('<span class="contadorMercanciasEdit font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleMercanciaEdit").on('click', function () {
        var CPSI = false;
        var D = false;
        var C = false;
        var CUI = false;
        var PKG = false;
        var CTC = true;
        var CTCTI = true;
        var CTCO = true;
        var CTCD = true;
        var message;


            //pedimento
            var jsonPedimentos = [];
            $(".Pedimentos").each(function (index, element) {

                var Pedimento = $(element).find('#Pedimento').text().trim();

                jsonPedimentos.push({
                    "Pedimento": Pedimento
                });
            });
            //Guia identificacion
            var jsonGIdentificacion = [];

            $(".GIdentificacion").each(function (index, element) {

                var NumGuiaIdentificacion = $(element).find('#NumGuiaIdentificacion').text().trim();
                var DescripGuiaIdentificacion = $(element).find('#DescripGuiaIdentificacion').text().trim();
                var PesoGuiaIdentificacion = $(element).find('#PesoGuiaIdentificacion').text().trim();

                jsonGIdentificacion.push({
                    "NumeroGuiaIdentificacion": NumGuiaIdentificacion, "DescripGuiaIdentificacion": DescripGuiaIdentificacion, "PesoGuiaIdentificacion": PesoGuiaIdentificacion
                });
            });
            //Cantidad transportada
            var jsonCTransportadas = [];

            $(".CTransportadas").each(function (index, element) {

                var Cantidad = $(element).find('#Cantidad').text().trim();
                var CveTransporte = $(element).find('#CveTransporte').text().trim();
                var IDOrigen = $(element).find('#IDOrigen').text().trim();
                var IDDestino = $(element).find('#IDDestino').text().trim();

                jsonCTransportadas.push({
                    "Cantidad": Cantidad, "CveTransporte_Id": CveTransporte, "IDOrigen": IDOrigen, "IDDestino": IDDestino
                });
            });

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarMercanciaEdit", "AjaxOperaciones")',
                data: JSON.stringify({
                    ClaveProdServID: $('#Mercancias_Mercancia_ClaveProdServCP').val(),//option:selected
                    ClaveProdSTCCID: $('#Mercancias_Mercancia_ClaveProdSTCC').val(),//option:selected
                    Descripcion: $('#Mercancias_Mercancia_Descripcion').val(),
                    Cantidad: $('#Mercancias_Mercancia_Cantidad').val(),
                    Unidad: $('#Mercancias_Mercancia_Unidad').val(),
                    ClaveUnidadID: $('#Mercancias_Mercancia_ClavesUnidad').val(),
                    Dimensiones: $('#Mercancias_Mercancia_Dimensiones').val(),
                    MaterialPeligorosoSN: $('#Mercancias_Mercancia_MaterialPeligrosos').val(),
                    MaterialPeligrosoID: $('#Mercancias_Mercancia_ClaveMaterialPeligroso').val(),
                    DescripcionEmbalaje: $('#Mercancias_Mercancia_DescripEmbalaje option:selected').text(),
                    TipoEmbalajeID: $('#Mercancias_Mercancia_TipoEmbalaje_Id').val(),
                    PesoEnKg: $('#Mercancias_Mercancia_PesoEnKg').val(),
                    ValorMercancia: $('#Mercancias_Mercancia_ValorMercancia').val(),
                    Moneda: $('#Mercancias_Mercancia_Moneda').val(),
                    FraccionArancelariaID: $('#Mercancias_Mercancia_FraccionArancelarias').val(),
                    UUIDComercioExt: $('#Mercancias_Mercancia_UUIDComecioExt').val(),
                    DEClaveUnidadPesoID: $('#Mercancias_Mercancia_DetalleMercancia_ClaveUnidadPeso_Id').val(),//option:selected
                    DEPesoBruto: $('#pesoBruto').val(),
                    DEPEsoNeto: $('#pesoNeto').val(),
                    DEPesoTara: $('#pesoTara').val(),
                    DENumPiezas: $('#Mercancias_Mercancia_DetalleMercancia_NumPiezas').val(),
                    PedimentoArray: jsonPedimentos,
                    GIdentificacionArray: jsonGIdentificacion,
                    CTransportadaArray: jsonCTransportadas,
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesMercancias').append(partialView);
                    var totalMercancia = $(".mercanciaEdit").length;

                    $("#Mercancias_NumTotalMercancias").val(totalMercancia);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
             });
            return false;

        });
    });

    function removeDetalleMercanciaEdit(elem) {
        var totalU = $(".mercanciaEdit").length;
        if (totalU > 0) {
            var contador = $(".mercanciaEdit").length - 1;
            $(".contadorMercanciasEdit").replaceWith('<span class="contadorMercanciasEdit font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorMercanciasEdit").replaceWith('<span class="contadorMercanciasEdit font-blue">');
        }
        $(elem).parent().parent().parent().remove();
        var totalMercancia = $(".mercanciaEdit").length;

        $("#Mercancias_NumTotalMercancias").val(totalMercancia);
    }

    /////////////





    //DETALLE FIGURA TRANSPORTE
    var contadorPTransporte = 0;
    $(function () {
        $('#agregarDetalleFTransporte').click(function () {
            var contador = $(".FTransporte").length + 1;
        $(".contadorFTransporte").replaceWith('<span class="contadorFTransporte font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleFTransporte").on('click', function () {
        var TFT = false;
        var PTransporte = $('.PTransporte');
        var message;
        var FTransporte = $('#TipoFiguraTransporte').val();
        message = "#TFFiguraTransporte";
        TFT = Boolean(ValidaCampos(FTransporte, message));

        if (!TFT) {

        } else {
            var jsonParteTransporte = [];

            $(".PTransporte").each(function (index, element) {

                var ParteTransporte = $(element).find('#ParteTransporte').text().trim();
                jsonParteTransporte.push({
                    "ParteTransporte": ParteTransporte
                });
            });

            var ORPais = $("#TiposFigura_Domicilio_Paises option:selected").val();
            if (ORPais === "" || ORPais === null || ORPais == undefined || ORPais === "Seleccionar") {
                ORPais = "";
            }
            var ORPaisText = $("#TiposFigura_Domicilio_Paises option:selected").text();
            if (ORPaisText === "" || ORPaisText === null || ORPaisText == undefined || ORPaisText === "Seleccionar") {
                ORPaisText = "";
            }
            var OREstado = $('#TiposFigura_Domicilio_ddlEstados option:selected').val();
            var OREstadoText = $("#TiposFigura_Domicilio_ddlEstados option:selected").text();
            if (OREstado === "" || OREstado === null || OREstado == undefined) {
                OREstado = $('#TiposFigura_Domicilio_Estado').val();
                OREstadoText = OREstado;
            }

            var DEMunicipio = $('#TiposFigura_Domicilio_ddlMunicipios option:selected').val();
            var DEMunicipioText = $("#TiposFigura_Domicilio_ddlMunicipios option:selected").text();
            if (DEMunicipio === "" || DEMunicipio === null || DEMunicipio == undefined) {
                DEMunicipio = $('#TiposFigura_Domicilio_Municipio').val();
                DEMunicipioText = DEMunicipio;
            }
            var DELocalidad = $('#TiposFigura_Domicilio_ddlLocalidades option:selected').val();
            var DELocalidadText = $("#TiposFigura_Domicilio_ddlLocalidades option:selected").text();
            if (DELocalidad === "" || DELocalidad === null || DELocalidad == undefined) {
                DELocalidad = $('#TiposFigura_Domicilio_Localidad').val();
                DELocalidadText = DELocalidad;
            }
            var DEColonia = $('#TiposFigura_Domicilio_ddlColonias option:selected').val();
            var DEColoniaText = $("#TiposFigura_Domicilio_ddlColonias option:selected").text();
            if (DEColonia === "" || DEColonia === null || DEColonia == undefined) {
                DEColonia = $('#TiposFigura_Domicilio_Colonia').val();
                DEColoniaText = DEColonia;
            }

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarFTransporte", "AjaxOperaciones")',
                data: JSON.stringify({
                    FTransporte: $('#TipoFiguraTransporte option:selected').val(),
                    RFCFigura: $('#TiposFigura_RFCFigura').val(),
                    NumLicencia: $('#TiposFigura_NumLicencia').val(),
                    NombreFigura: $('#TiposFigura_NombreFigura').val(),
                    NumRegIdTribFigura: $('#TiposFigura_NumRegIdTribFigura').val(),
                    ResidenciaFiscalFigura: $('#TiposFigura_ResidenciaFiscalFigura').val(),
                    Pais: $('#TiposFigura_Domicilio_Paises').val(),
                    PaisText: ORPaisText,
                    Estado: OREstado,
                    EstadoText: OREstadoText,
                    Municipio: DEMunicipio,
                    MunicipioText: DEMunicipioText,
                    Localidad: DELocalidad,
                    LocalidadText: DELocalidadText,
                    CodigoPostal: $('#TiposFigura_Domicilio_CodigoPostal').val(),
                    Colonia: DEColonia,
                    ColoniaText: DEColoniaText,
                    Calle: $('#TiposFigura_Domicilio_Calle').val(),
                    NumExterior: $('#TiposFigura_Domicilio_NumeroExterior').val(),
                    NumInterior: $('#TiposFigura_Domicilio_NumeroInterior').val(),
                    Referencia: $('#TiposFigura_Domicilio_Referencia').val(),
                    PartesTransporte: jsonParteTransporte
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesFTransporte').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
               });
            return false;
        }
        });
    });

    function removeDetalleFTransporte(elem) {
        var totalU = $(".FTransporte").length;
        if (totalU > 0) {
            var contador = $(".FTransporte").length - 1;
            $(".contadorFTransporte").replaceWith('<span class="contadorFTransporte font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorFTransporte").replaceWith('<span class="contadorFTransporte font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }
    //DETALLE PARTES TRANSPORTE

    $(function () {
        $('#agregarDetallePTransporte').click(function () {
            contadorPTransporte = $(".PTransporte").length + 1;
        $(".contadorPTransporte").replaceWith('<span class="contadorPTransporte font-blue">: ' + contadorPTransporte + '</span >');
    });
    });

    $(function () {
    $("#agregarDetallePTransporte").on('click', function () {

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarPTransporte", "AjaxOperaciones")',
                data: JSON.stringify({
                    PTransporte: $('#TiposFigura_PartesTransporte_ParteTransporte').val()
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesPTransporte').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
              });
            return false;
        });
    });

    function removeDetallePTransporte(elem) {
        var totalU = $(".PTransporte").length;
        if (totalU > 0) {
            var contador = $(".PTransporte").length - 1;
            contadorPTransporte = contador;
            $(".contadorPTransporte").replaceWith('<span class="contadorPTransporte font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorPTransporte").replaceWith('<span class="contadorPTransporte font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }

    /****************************/
    //DETALLE CFDI RELACIONADO

    $(function () {
        $('#agregarDetalleCRelacionado').click(function () {
            contadorCRelacionado = $(".CRelacionado").length + 1;
        $(".contadorCRelacionado").replaceWith('<span class="contadorCRelacionado font-blue">: ' + contadorCRelacionado + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleCRelacionado").on('click', function () {

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarCfdiRelacionado", "AjaxOperaciones")',
                data: JSON.stringify({
                    TipoRelacion: $('#CfdiRelacionado_TipoRelacion').val(),
                    UUID: $('#CfdiRelacionado_UUIDCfdiRelacionado').val()
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesCRelacionado').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
              });
            return false;
        });
    });

    function removeDetalleCRelacionado(elem) {
        var totalU = $(".CRelacionado").length;
        if (totalU > 0) {
            var contador = $(".CRelacionado").length - 1;
            contadorCRelacionado = contador;
            $(".contadorCRelacionado").replaceWith('<span class="contadorCRelacionado font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorCRelacionado").replaceWith('<span class="contadorCRelacionado font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }

    /***************************/
    //DETALLE TRANSPORTE MARITIMO CONTENEDOR
    $(function () {
        $('#agregarDetalleTMContenedor').click(function () {
            var contador = $(".TMContenedor").length + 1;
        $(".contadorTMContenedor").replaceWith('<span class="contadorTMContenedor font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
        $("#agregarDetalleTMContenedor").on('click', function () {
            var MT = false;
            var CMI = false;


            var message;
            var MatContenedor = $('#Mercancias_TransporteMaritimo_ContenedorM_MatriculaContenedor').val();
            message = "#MatContenedor";
            MT = Boolean(ValidaCampos(MatContenedor, message));
            var ContenedorMaritId = $('#contenedorMaritimo option:selected').val();
            message = "#ContenedorMaritId";
            CMI = Boolean(ValidaCampos(ContenedorMaritId, message));
            if (!MT || !CMI) {

            } else {

                $.ajax({
                    type: 'POST',
                    url: ' @Url.Action("AgregarTMContenedor", "AjaxOperaciones")',
                    data: JSON.stringify({
                        MatContenedor: $('#Mercancias_TransporteMaritimo_ContenedorM_MatriculaContenedor').val(),
                        ContenedorMaritId: $('#contenedorMaritimo option:selected').val(),//option:selected
                        NumPrecinto: $('#Mercancias_TransporteMaritimo_ContenedorM_NumPrecinto').val()
                    }),
                    dataType: 'html',
                    contentType: "application/json; charset=utf-8",
                    success: function (partialView) {
                        $('#detallesTMContenedor').append(partialView);
                    },
                    error: function (jqxhr, textStatus, error) {
                        alert("Favor de llenar todos los datos para los detalles");
                    }
                  });
                return false;
            }
        });
    });

    function removeDetalleTMContenedorC(elem) {
        var totalU = $(".TMContenedor").length;
        if (totalU > 0) {
            var contador = $(".TMContenedor").length - 1;
            $(".contadorTMContenedor").replaceWith('<span class="contadorTMContenedor font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorTMContenedor").replaceWith('<span class="contadorTMContenedor font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }


    //DETALLE TRANSPORTE MARITIMO CONTENEDOR EDITAR
    $(function () {
        $('#agregarDetalleTMContenedorEdit').click(function () {
            var contador = $(".TMContenedorEdit").length + 1;
        $(".contadorTMContenedorEdit").replaceWith('<span class="contadorTMContenedorEdit font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
        $("#agregarDetalleTMContenedorEdit").on('click', function () {
            var MT = false;
            var CMI = false;


            var message;
            var MatContenedor = $('#Mercancias_TransporteMaritimo_ContenedorM_MatriculaContenedor').val();
            message = "#MatContenedor";
            MT = Boolean(ValidaCampos(MatContenedor, message));
            var ContenedorMaritId = $('#contenedorMaritimo option:selected').val();
            message = "#ContenedorMaritId";
            CMI = Boolean(ValidaCampos(ContenedorMaritId, message));
            if (!MT || !CMI) {

            } else {

                $.ajax({
                    type: 'POST',
                    url: ' @Url.Action("AgregarTMContenedorEdit", "AjaxOperaciones")',
                    data: JSON.stringify({
                        MatContenedor: $('#Mercancias_TransporteMaritimo_ContenedorM_MatriculaContenedor').val(),
                        ContenedorMaritId: $('#contenedorMaritimo option:selected').val(),//option:selected
                        NumPrecinto: $('#Mercancias_TransporteMaritimo_ContenedorM_NumPrecinto').val()
                    }),
                    dataType: 'html',
                    contentType: "application/json; charset=utf-8",
                    success: function (partialView) {
                        $('#detallesTMContenedor').append(partialView);
                    },
                    error: function (jqxhr, textStatus, error) {
                        alert("Favor de llenar todos los datos para los detalles");
                    }
                   });
                return false;
            }
        });
    });

    function removeDetalleTMContenedor(elem) {
        var totalU = $(".TMContenedorEdit").length;
        if (totalU > 0) {
            var contador = $(".TMContenedorEdit").length - 1;
            $(".contadorTMContenedorEdit").replaceWith('<span class="contadorTMContenedorEdit font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorTMContenedorEdit").replaceWith('<span class="contadorTMContenedorEdit font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }
    //////////////////////

    //DETALLE TRANSPORTE FERROVIARIO DERECHOS DE PASO
    $(function () {
        $('#agregarDetalleTFDPaso').click(function () {
            var contador = $(".TFDPaso").length + 1;
        $(".contadorTFDPaso").replaceWith('<span class="contadorTFDPaso font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleTFDPaso").on('click', function () {
        var TDPI = false;
        var KP = false;

        var message;
        var TipoDPasoID = $('#Mercancias_TransporteFerroviario_DerechosDePasos_TipoDerechoDePaso_Id').val();
        message = "#TipoDerechosDePasoId";
        TDPI = Boolean(ValidaCampos(TipoDPasoID, message));
        var KilPagado = $('#Mercancias_TransporteFerroviario_DerechosDePasos_KilometrajePagado').val();
        message = "#KilPagado";
        KP = Boolean(ValidaCampos(KilPagado, message));


        if (!TDPI || !KP) {

        } else {
            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarTFDPaso", "AjaxOperaciones")',
                data: JSON.stringify({
                    TipoDPasoID: $('#Mercancias_TransporteFerroviario_DerechosDePasos_TipoDerechoDePaso_Id').val(),//option:selected
                    KilPagado: $('#Mercancias_TransporteFerroviario_DerechosDePasos_KilometrajePagado').val()
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesTFDPaso').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
               });
            return false;
        }
        });
    });

    function removeDetalleTFDPasoC(elem) {
        var totalU = $(".TFDPaso").length;
        if (totalU > 0) {
            var contador = $(".TFDPaso").length - 1;
            $(".contadorTFDPaso").replaceWith('<span class="contadorTFDPaso font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorTFDPaso").replaceWith('<span class="contadorTFDPaso font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }
    ///DETALLE TRASNPORTE FERROVIARIO DERECHO DE PASOS EDITAR
    $(function () {
        $('#agregarDetalleTFDPasoEdit').click(function () {
            var contador = $(".TFDPasoEdit").length + 1;
        $(".contadorTFDPasoEdit").replaceWith('<span class="contadorTFDPasoEdit font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleTFDPasoEdit").on('click', function () {
        var TDPI = false;
        var KP = false;

        var message;
        var TipoDPasoID = $('#Mercancias_TransporteFerroviario_DerechosDePasos_TipoDerechoDePaso_Id').val();
        message = "#TipoDerechosDePasoId";
        TDPI = Boolean(ValidaCampos(TipoDPasoID, message));
        var KilPagado = $('#Mercancias_TransporteFerroviario_DerechosDePasos_KilometrajePagado').val();
        message = "#KilPagado";
        KP = Boolean(ValidaCampos(KilPagado, message));


        if (!TDPI || !KP) {

        } else {
            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarTFDPasoEdit", "AjaxOperaciones")',
                data: JSON.stringify({
                    TipoDPasoID: $('#Mercancias_TransporteFerroviario_DerechosDePasos_TipoDerechoDePaso_Id').val(),//option:selected
                    KilPagado: $('#Mercancias_TransporteFerroviario_DerechosDePasos_KilometrajePagado').val()
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesTFDPaso').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
              });
            return false;
        }
        });
    });

    function removeDetalleTFDPaso(elem) {
        var totalU = $(".TFDPasoEdit").length;
        if (totalU > 0) {
            var contador = $(".TFDPasoEdit").length - 1;
            $(".contadorTFDPasoEdit").replaceWith('<span class="contadorTFDPasoEdit font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorTFDPasoEdit").replaceWith('<span class="contadorTFDPasoEdit font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }

    //////
     //DETALLE TRANSPORTE FERROVIARIO CARRO
    $(function () {
        $('#agregarDetalleTFCarro').click(function () {
            var contador = $(".TFCarro").length + 1;

        $(".contadorTFCarro").replaceWith('<span class="contadorTFCarro font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleTFCarro").on('click', function () {
        var TCI = false;
        var MC = false;
        var GC = false;
        var TNC = false;
        var Contenedor = $('.TFContenedor');
        var message;
        var TipoCarroID = $('#Mercancias_TransporteFerroviario_Carro_TipoCarro_Id').val();
        message = "#TFTipoCarroID";
        TCI = Boolean(ValidaCampos(TipoCarroID, message));
        var MatriculaCarro = $('#Mercancias_TransporteFerroviario_Carro_MatriculaCarro').val();
        message = "#TFMatriculaCarro";
        MC = Boolean(ValidaCampos(MatriculaCarro, message));
        var GuiaCarro = $('#Mercancias_TransporteFerroviario_Carro_GuiaCarro').val();
        message = "#TFGuiaCarro";
        GC = Boolean(ValidaCampos(GuiaCarro, message));
        var TonNetasCarro = $('#Mercancias_TransporteFerroviario_Carro_ToneladasNetasCarro').val();
        message = "#TFTNetasCarro";
        TNC = Boolean(ValidaCampos(TonNetasCarro, message));

        if (!TCI || !MC || !GC || !TNC) {

        } else {

            var jsonCarroContenedor = [];

            $(".TFContenedor").each(function (index, element) {

                var ContenedorId = $(element).find('#ContenedorId').text().trim();
                var PesoCVacio = $(element).find('#PesoCVacio').text().trim();
                var PesoNMercancia = $(element).find('#PesoNMercancia').text().trim();

                jsonCarroContenedor.push({
                    "Contenedor_Id": ContenedorId, "PesoContenedorVacio": PesoCVacio, "PesoNetoMercancia": PesoNMercancia
                });

            });

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarTFCarro", "AjaxOperaciones")',
                data: JSON.stringify({
                    TipoCarroID: $('#Mercancias_TransporteFerroviario_Carro_TipoCarro_Id').val(),//option:selected
                    MatriculaCarro: $('#Mercancias_TransporteFerroviario_Carro_MatriculaCarro').val(),
                    GuiaCarro: $('#Mercancias_TransporteFerroviario_Carro_GuiaCarro').val(),
                    TonNetasCarro: $('#Mercancias_TransporteFerroviario_Carro_ToneladasNetasCarro').val(),
                    ContenedorC: jsonCarroContenedor
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesTFCarro').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
              });
            return false;
        }
        });
    });

    function removeDetalleTFCarroC(elem) {
        var totalU = $(".TFCarro").length;
        if (totalU > 0) {
            var contador = $(".TFCarro").length - 1;
            $(".contadorTFCarro").replaceWith('<span class="contadorTFCarro font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorTFCarro").replaceWith('<span class="contadorTFCarro font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }

     //DETALLE TRANSPORTE FERROVIARIO CARRO EDITAR
    $(function () {
        $('#agregarDetalleTFCarroEdit').click(function () {
            var contador = $(".TFCarroEdit").length + 1;

        $(".contadorTFCarroEdit").replaceWith('<span class="contadorTFCarroEdit font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleTFCarroEdit").on('click', function () {
        var TCI = false;
        var MC = false;
        var GC = false;
        var TNC = false;
        var Contenedor = $('.TFContenedor');
        var message;
        var TipoCarroID = $('#Mercancias_TransporteFerroviario_Carro_TipoCarro_Id').val();
        message = "#TFTipoCarroID";
        TCI = Boolean(ValidaCampos(TipoCarroID, message));
        var MatriculaCarro = $('#Mercancias_TransporteFerroviario_Carro_MatriculaCarro').val();
        message = "#TFMatriculaCarro";
        MC = Boolean(ValidaCampos(MatriculaCarro, message));
        var GuiaCarro = $('#Mercancias_TransporteFerroviario_Carro_GuiaCarro').val();
        message = "#TFGuiaCarro";
        GC = Boolean(ValidaCampos(GuiaCarro, message));
        var TonNetasCarro = $('#Mercancias_TransporteFerroviario_Carro_ToneladasNetasCarro').val();
        message = "#TFTNetasCarro";
        TNC = Boolean(ValidaCampos(TonNetasCarro, message));

        if (!TCI || !MC || !GC || !TNC) {

        } else {

            var jsonCarroContenedor = [];

            $(".TFContenedor").each(function (index, element) {

                var ContenedorId = $(element).find('#ContenedorId').text().trim();
                var PesoCVacio = $(element).find('#PesoCVacio').text().trim();
                var PesoNMercancia = $(element).find('#PesoNMercancia').text().trim();

                jsonCarroContenedor.push({
                    "Contenedor_Id": ContenedorId, "PesoContenedorVacio": PesoCVacio, "PesoNetoMercancia": PesoNMercancia
                });

            });

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarTFCarroEdit", "AjaxOperaciones")',
                data: JSON.stringify({
                    TipoCarroID: $('#Mercancias_TransporteFerroviario_Carro_TipoCarro_Id').val(),//option:selected
                    MatriculaCarro: $('#Mercancias_TransporteFerroviario_Carro_MatriculaCarro').val(),
                    GuiaCarro: $('#Mercancias_TransporteFerroviario_Carro_GuiaCarro').val(),
                    TonNetasCarro: $('#Mercancias_TransporteFerroviario_Carro_ToneladasNetasCarro').val(),
                    ContenedorC: jsonCarroContenedor
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesTFCarro').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
              });
            return false;
        }
        });
    });

    function removeDetalleTFCarro(elem) {
        var totalU = $(".TFCarroEdit").length;
        if (totalU > 0) {
            var contador = $(".TFCarroEdit").length - 1;
            $(".contadorTFCarroEdit").replaceWith('<span class="contadorTFCarroEdit font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorTFCarroEdit").replaceWith('<span class="contadorTFCarroEdit font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }

     //DETALLE TRANSPORTE FERROVIARIO CARRO CONTENEDOR
    $(function () {
        $('#agregarDetalleTFContenedor').click(function () {
            var contador = $(".TFContenedor").length + 1;
        $(".contadorTFContenedor").replaceWith('<span class="contadorTFContenedor font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
        $("#agregarDetalleTFContenedor").on('click', function () {
            var C = false;
            var PCV = false;
            var PNM = false;

            var message;
            var ContenedorID = $('#contenedorTransFerr option:selected').val();
            message = "#MTFcontenedorId";
            C = Boolean(ValidaCampos(ContenedorID, message));
            var PesoContenedorVacio = $('#Mercancias_TransporteFerroviario_Carro_ContenedorC_PesoContenedorVacio').val();
            message = "#MTFPesoContenedorVacio";
            PCV = Boolean(ValidaCampos(PesoContenedorVacio, message));
            var pesoNetoMercancia = $('#Mercancias_TransporteFerroviario_Carro_ContenedorC_PesoNetoMercancia').val();
            message = "#MTFPesoNetoMercancia";
            PNM = Boolean(ValidaCampos(pesoNetoMercancia, message));

            if (!C || !PCV || !PNM ) {

            } else {

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarTFContenedor", "AjaxOperaciones")',
                data: JSON.stringify({
                    ContenedorID: $('#contenedorTransFerr option:selected').val(),//option:selected
                    PesoContenedorVacio: $('#Mercancias_TransporteFerroviario_Carro_ContenedorC_PesoContenedorVacio').val(),
                    pesoNetoMercancia: $('#Mercancias_TransporteFerroviario_Carro_ContenedorC_PesoNetoMercancia').val()
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesTFContenedor').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
               });
              return false;
             }
        });
    });

    function removeDetalleTFContenedor(elem) {
        var totalU = $(".TFContenedor").length;
        if (totalU > 0) {
            var contador = $(".TFContenedor").length - 1;
            $(".contadorTFContenedor").replaceWith('<span class="contadorTFContenedor font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorTFContenedor").replaceWith('<span class="contadorTFContenedor font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }

    function ValidaCampos(input, div) {

        if (input === "" || input === null || input == undefined) {

            $(div).html("Campo Obligatorio");
            $(div).show(200);
            return false;
        } else {
            $(div).html("");
            $(div).hide(200);
            return true;
        }

    }

    function ValidaCamposVaciosUbicacionDomicilio(input, div) {

        if (input === "" || input === null || input == undefined) {

            return false;
        } else {
            return true;
        }

    }

    //DETALLE MERCANCIA PEDIMENTOS
    $(function () {
    $('#agregarDetallePedimentos').click(function () {
        var contador = $(".Pedimentos").length + 1;
        $(".contadorPedimentos").replaceWith('<span class="contadorPedimentos font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetallePedimentos").on('click', function () {

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarPedimentos", "AjaxOperaciones")',
                data: JSON.stringify({
                    Pedimento: $('#Mercancias_Mercancia_Pedimentos_Pedimento').val()
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesPedimentos').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }

                });
            return false;
        });
    });

    function removeDetallePedimentos(elem) {
        var totalU = $(".Pedimentos").length;
        if (totalU > 0) {
            var contador = $(".Pedimentos").length - 1;
            $(".contadorPedimentos").replaceWith('<span class="contadorPedimentos font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorPedimentos").replaceWith('<span class="contadorPedimentos font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }

    //DETALLE MERCANCIA GUIAS  DE IDENTIFICACION
    $(function () {
        $('#agregarDetalleGIdentificacion').click(function () {
            var contador = $(".GIdentificacion").length + 1;
        $(".contadorGIdentificacion").replaceWith('<span class="contadorGIdentificacion font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleGIdentificacion").on('click', function () {

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarGIdentificacion", "AjaxOperaciones")',
                data: JSON.stringify({
                    NumGuiIdentificacion: $('#Mercancias_Mercancia_GuiasIdentificacion_NumeroGuiaIdentificacion').val(),
                    DescripGuiaIdentificacion: $('#Mercancias_Mercancia_GuiasIdentificacion_DescripGuiaIdentificacion').val(),
                    PesoGuiaIdentificacion: $('#Mercancias_Mercancia_GuiasIdentificacion_PesoGuiaIdentificacion').val()
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesGIdentificacion').append(partialView);
                },
            error: function (jqxhr, textStatus, error) {
                alert("Favor de llenar todos los datos para los detalles");
            }

            });
            return false;
        });
    });

    function removeDetalleGIdentificacion(elem) {
        var totalU = $(".GIdentificacion").length;
        if (totalU > 0) {
            var contador = $(".GIdentificacion").length - 1;
            $(".contadorGIdentificacion").replaceWith('<span class="contadorGIdentificacion font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorGIdentificacion").replaceWith('<span class="contadorGIdentificacion font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }

    //DETALLE MERCANCIA CANTIDAD TRANSPORTADAS
    $(function () {
        $('#agregarDetalleCTransportadas').click(function () {
            var contador = $(".CTransportadas").length + 1;
        $(".contadorCTransportadas").replaceWith('<span class="contadorCTransportadas font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleCTransportadas").on('click', function () {

            $.ajax({
                type: 'POST',
                url: ' @Url.Action("AgregarCTransportadas", "AjaxOperaciones")',
                data: JSON.stringify({
                    Cantidad: $('#Mercancias_Mercancia_CantidadTransportada_Cantidad').val(),
                    CveTransporteID: $('#Mercancias_Mercancia_CantidadTransportada_CveTransporte_Id').val(),
                    UbicacionOrigenID: $('#Mercancias_Mercancia_CantidadTransportada_IDOrigen').val(),
                    UbicacionDestinoID: $('#Mercancias_Mercancia_CantidadTransportada_IDDestino').val()
                }),
                dataType: 'html',
                contentType: "application/json; charset=utf-8",
                success: function (partialView) {
                    $('#detallesCTransportadas').append(partialView);
                },
                error: function (jqxhr, textStatus, error) {
                    alert("Favor de llenar todos los datos para los detalles");
                }
             });
            return false;
        });
    });

    function removeDetalleCTransportadas(elem) {
        var totalU = $(".CTransportadas").length;
        if (totalU > 0) {
            var contador = $(".CTransportadas").length - 1;
            $(".contadorCTransportadas").replaceWith('<span class="contadorCTransportadas font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorCTransportadas").replaceWith('<span class="contadorCTransportadas font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }
    //DETALLE CONCEPTOS
    //function para verificar que se haya seleccionado una opcion
    function comprobarDropDown(id) {
        var ConceptosError = $("#" + id).val();

        if (ConceptosError == "") {
            $("#" + id + "_Error").text("Campo Obligatorio");
            return false;
        } else {
            $("#" + id + "_Error").text("");
        }
    }
    //Elimina mensaje error objeto impuesto
    $(function () {
        $("#Conceptos_ObjetoImpuesto").change(function () {
            comprobarDropDown("Conceptos_ObjetoImpuesto");
        });
    });

    $(function () {
        $('#agregarDetalleConceptos').click(function () {
            var contador = $(".conceptos").length + 1;
        $(".contadorConceptos").replaceWith('<span class="contadorConceptos font-blue">: ' + contador + '</span >');
    });
    });

    $(function () {
    $("#agregarDetalleConceptos").on('click', function () {
        //validación para ver si se ha seleccionado una opcion
        if (comprobarDropDown("Conceptos_ObjetoImpuesto") == false) {
            return false;
        }
        $.ajax({
            type: 'POST',
            url: ' @Url.Action("AgregarConceptos", "AjaxOperaciones")',
            data: JSON.stringify({
                ClaveProdServID: $('#Conceptos_ClavesProdServ').val(),
                ClaveUnidadID: $('#Conceptos_ClavesUnidad').val(),
                Unidad: $('#Conceptos_Unidad').val(),
                Descripcion: $('#Conceptos_Descripcion').val(),
                NumIdentificacion: $('#Conceptos_NoIdentificacion').val(),
                Cantidad: $('#Conceptos_Cantidad').val(),
                ValorUnitario: $('#Conceptos_ValorUnitario').val(),
                Importe: $('#Conceptos_Importe').val(),
                ObjetoImpuesto: $('#Conceptos_ObjetoImpuesto').val(),
                TTipoImpuesto: $("#Conceptos_Traslado_TipoImpuesto").val(),
                TBase: $('#TBase').val(),
                TImpuesto: $('#Conceptos_Traslado_Impuesto').val(),
                TTipoFactor: $('#Conceptos_Traslado_TipoFactor').val(),
                TTasaOCuota: $('#TTasaOCuota').val(),
                TImporte: $('#TImporte').val(),
                //TTImpuestosTR: $('#TTotal').val(),
                RTipoImpuesto: $("#Conceptos_Retencion_TipoImpuesto").val(),
                RImpuesto: $('#Conceptos_Retencion_Impuesto').val(),
                RBase: $('#RBase').val(),
                RTipofactor: $('#Conceptos_Retencion_TipoFactor').val(),
                RTasaOCuota: $('#RTasaOCuota').val(),
                RImporte: $('#RImporte').val(),
                ///RTImpuestoTR: $('#RTotal').val()

            }),
            dataType: 'html',
            contentType: "application/json; charset=utf-8",
            success: function (partialView) {
                $('#detallesConceptos').append(partialView);
                // incrementaDecrementaImportes();
            },
            error: function (jqxhr, textStatus, error) {
                alert("Favor de llenar todos los datos para los detalles ");
            }
           });

            return false;
        });
    });

    function removeDetalleConceptos(elem) {
        var totalU = $(".conceptos").length;
        if (totalU > 0) {

            var contador = $(".conceptos").length - 1;
            $(".contadorConceptos").replaceWith('<span class="contadorConceptos font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorConceptos").replaceWith('<span class="contadorConceptos font-blue">');
        }

        $(elem).parent().parent().parent().remove();
        //incrementaDecrementaImportes();
    }

    function incrementaDecrementaImportes() {
        var sumaImporte = 0;
        var sumatImporte = 0;
        var sumarImporte = 0;
        if ($("#tipoComprobante").val() === "I") {
            $(".conceptos").each(function (index, element) {

                var cImporte = $(element).find('#cImporte').text().trim();
                var tImporte = $(element).find('#tImporte').text().trim();
                var rImporte = $(element).find('#rImporte').text().trim();
                sumaImporte += Number(cImporte);
                sumatImporte += Number(tImporte);
                sumarImporte += Number(rImporte);
            });

            $('#subtotal').val(parseFloat(sumaImporte));
            //calcula Total

            var total = (parseFloat(sumaImporte) + parseFloat(sumatImporte)) - parseFloat(sumarImporte);
            $('#total').val(total);
        }
    }

    // DETALLE REMOLQUES

     $(function () {
         $('#agregarDetalleRemolqueAuTransp').click(function () {
             var RemolqueLegth = $('.RemolqueAutoTransp').length;
             if (RemolqueLegth < 2) {
                 var contador = $(".RemolqueAutoTransp").length + 1;
                 $(".contadorRemolquesAuTransp").replaceWith('<span class="contadorRemolquesAuTransp font-blue">: ' + contador + '</span >');
             }
             });
    });

    $(function () {
        $("#agregarDetalleRemolqueAuTransp").on('click', function () {
            var RemolqueLegth = $('.RemolqueAutoTransp').length;
            if (RemolqueLegth > 1) {
                alert("No puedes agregar mas de dos Remolques")
            } else {
                $.ajax({
                    type: 'POST',
                    url: ' @Url.Action("AgregarRemolque", "AjaxOperaciones")',
                    data: JSON.stringify({
                        Placa: $('#Mercancias_AutoTransporte_Remolque_Placa').val(),
                        TipoRemolqueId: $('#Mercancias_AutoTransporte_Remolque_SubTipoRem_Id').val(),
                        TipoRemolque: $('#Mercancias_AutoTransporte_Remolque_SubTipoRem_Id').text()
                    }),
                    dataType: 'html',
                    contentType: "application/json; charset=utf-8",
                    success: function (partialView) {
                        $('#detallesRemolqueAuTransp').append(partialView);
                    },
                    error: function (jqxhr, textStatus, error) {
                        alert("Favor de llenar todos los datos para los detalles");
                    }
                 });
                return false;
            }
        });
    });

    function removeDetalleRemolqueC(elem) {
        var totalU = $(".RemolqueAutoTransp").length;
        if (totalU > 0) {
            var contador = $(".RemolqueAutoTransp").length - 1;
            $(".contadorRemolquesAuTransp").replaceWith('<span class="contadorRemolquesAuTransp font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorRemolquesAuTransp").replaceWith('<span class="contadorRemolquesAuTransp font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }

    // DETALLE REMOLQUES EDITAR

     $(function () {
         $('#agregarDetalleRemolqueAuTranspEdit').click(function () {
             var RemolqueLegth = $('.RemolqueAutoTranspEdit').length;
             if (RemolqueLegth < 2) {
                 var contador = $(".RemolqueAutoTranspEdit").length + 1;
                 $(".contadorRemolquesAuTranspEdit").replaceWith('<span class="contadorRemolquesAuTranspEdit font-blue">: ' + contador + '</span >');
             }
             });
    });

    $(function () {
        $("#agregarDetalleRemolqueAuTranspEdit").on('click', function () {
            var RemolqueLegth = $('.RemolqueAutoTranspEdit').length;
            if (RemolqueLegth > 1) {
                alert("No puedes agregar mas de dos Remolques")
            } else {
                $.ajax({
                    type: 'POST',
                    url: ' @Url.Action("AgregarRemolqueEdit", "AjaxOperaciones")',
                    data: JSON.stringify({
                        Placa: $('#Mercancias_AutoTransporte_Remolque_Placa').val(),
                        TipoRemolqueId: $('#Mercancias_AutoTransporte_Remolque_SubTipoRem_Id').val(),
                        TipoRemolque: $('#Mercancias_AutoTransporte_Remolque_SubTipoRem_Id').text()
                    }),
                    dataType: 'html',
                    contentType: "application/json; charset=utf-8",
                    success: function (partialView) {
                        $('#detallesRemolqueAuTransp').append(partialView);
                    },
                    error: function (jqxhr, textStatus, error) {
                        alert("Favor de llenar todos los datos para los detalles");
                    }
                 });
                return false;
            }
        });
    });

    function removeDetalleRemolque(elem) {
        var totalU = $(".RemolqueAutoTranspEdit").length;
        if (totalU > 0) {
            var contador = $(".RemolqueAutoTranspEdit").length - 1;
            $(".contadorRemolquesAuTranspEdit").replaceWith('<span class="contadorRemolquesAuTranspEdit font-blue">: ' + contador + '</span >');
        } else {
            $(".contadorRemolquesAuTranspEdit").replaceWith('<span class="contadorRemolquesAuTranspEdit font-blue">');
        }
        $(elem).parent().parent().parent().remove();
    }
    //Activa datetime input
    /*$(function () {
        $('.datetimepicker').datetimepicker({
            format: 'DD/MM/YYYY HH:mm'
            //sideBySide: true
        }); // format: 'YYYY/MM/DD HH:mm A'
        /*$('.time').datetimepicker({ format: 'HH:mm:ss' });
    });*/

    //valida campos por clave
    $(function () {
         //get descripcion claveProdServCP
         $('#Mercancias_Mercancia_ClaveProdServCP').on('keyup', function () {
             var claveProdServCP = $('#Mercancias_Mercancia_ClaveProdServCP').val();
            var div = "#ClaveProdServID";
             if (claveProdServCP != "") {
                 $.get("/ComplementosCartaPorte/DatosClaveProdServCP", { ClaveProdServCP: claveProdServCP }, function (data) {
                     if (data.length > 0) {
                         $.each(data, function (index, row) {
                             $("#Mercancias_Mercancia_Descripcion").val(row.Descripcion);
                         });
                         $(div).html("");
                     } else {
                         $(div).html("El dato ingresado no existe");
                         $("#Mercancias_Mercancia_Descripcion").val("");
                     }
                 });
             } else {
                 $(div).html("");
                 $("#Mercancias_Mercancia_Descripcion").val("");
             }

        });
         //valida claveProdSTCC de mercancia
         $('#Mercancias_Mercancia_ClaveProdSTCC').on('keyup', function () {
             var dato = $('#Mercancias_Mercancia_ClaveProdSTCC').val();
          var div = "#ClaveProdSTCC";

            var valid;
             if (dato != "") {
                 valid = ValidaEntrada(dato, div, "stcc");
             } else {
                 $(div).html("");
             }

         });
        //valida claveMaterialPeligroso
        $('#Mercancias_Mercancia_ClaveMaterialPeligroso').on('keyup', function () {
            var dato = $('#Mercancias_Mercancia_ClaveMaterialPeligroso').val();
            var div = "#ClaveMatPeligroso";

            var valid;
            if (dato != "") {
                valid = ValidaEntrada(dato, div, "MaterialPeligroso");
            } else {
                $(div).html("");
            }

        });

        //valida Clave unidad de mercancia y get descripcion
         $('#Mercancias_Mercancia_ClavesUnidad').on('keyup', function () {
             var claveUnidad = $('#Mercancias_Mercancia_ClavesUnidad').val();
             var div = "#ClaveUnidadId";
             if (claveUnidad != "") {
                 $.get("/ComplementosCartaPorte/DatosClaveUnidad", { ClaveUnidad: claveUnidad }, function (data) {
                     if (data.length > 0) {
                         $.each(data, function (index, row) {
                             //$("#Mercancias_Mercancia_Unidad").val(row.Nombre);
                         });
                         $(div).html("");
                     } else {
                         $(div).html("El dato ingresado no existe");
                         $("#Mercancias_Mercancia_Unidad").val("");
                     }
                 });
             } else {
                 $(div).html("");
                 $("#Mercancias_Mercancia_Unidad").val("");
             }


         });


         //conceptos clave unidad
         $('#Conceptos_ClavesUnidad').on('keyup', function () {
             var claveUnidad = $('#Conceptos_ClavesUnidad').val();
             var div = "#ClaveUnidadConcepto";
             if (claveUnidad != "") {
                 $.get("/ComplementosCartaPorte/DatosClaveUnidad", { ClaveUnidad: claveUnidad }, function (data) {
                     if (data.length > 0) {

                         $(div).html("");
                         $.each(data, function (index, row) {
                             $("#Conceptos_Unidad").val(row.Nombre);
                         });


                     } else {
                         $(div).html("El dato ingresado no existe");
                         $("#Conceptos_Unidad").val("");
                     }
                 });
             } else {
                 $(div).html("");
                 $("#Conceptos_Unidad").val("");
             }


         });
         //conceptos clave produdServ
         $('#Conceptos_ClavesProdServ').on('keyup', function () {
             var dato = $('#Conceptos_ClavesProdServ').val();
             var div = "#ClaveProdServCPConceptos";
             var valid;
             if (dato != "") {
                 valid = ValidaEntrada(dato, div, "claveServ");
             } else {
                 $(div).html("");
             }

         });

        //valida fraccion arancelaria
        $('#Mercancias_Mercancia_FraccionArancelarias').on('keyup', function () {
            var claveFraccion = $('#Mercancias_Mercancia_FraccionArancelarias').val();
            var div = "#ClaveFraccionArancelaria";
            if (claveFraccion != "") {
                $.get("/ComplementosCartaPorte/DatosFraccionArancelaria", { ClaveFraccion: claveFraccion }, function (data) {
                    if (data.length > 0) {
                        $(div).html("");

                    } else {
                        $(div).html("El dato ingresado no existe");

                    }
                });
            } else {
                $(div).html("");

            }


        });

         //set  Tipo embalaje_id
         $('#Mercancias_Mercancia_DescripEmbalaje').change(function () {
             var tipoEmbalaje = $('#Mercancias_Mercancia_DescripEmbalaje option:selected').val();
             $('#Mercancias_Mercancia_TipoEmbalaje_Id').val(tipoEmbalaje);
         });
    });
    function ValidaEntrada(input, div,t) {
         $.ajax({
                type: 'POST',
                url: ' @Url.Action("Buscar", "AjaxOperaciones")',
             data: JSON.stringify({
                 valor: input,
                 tipo: t
         }),
          dataType: 'html',
             contentType: "application/json; charset=utf-8",
             success: function (valor) {

                 if (valor == 0) {
                     $(div).html("El dato ingresado no existe");
                 }
                 else {
                     $(div).html("");
                 }

             },
             error: function (jqxhr, textStatus, error) {

             }
         });
    }




    ///SCRIPT CONCEPTOS PARA ACTIVAR DROPDOW Y RELLENAR LOS CAMPOS CONCEPTOS, RETENCIONES Y TRASLADOS

    $(function () {
        $('#CConcepto').change(function () {
            var ConceptosClaveProd = $("#CConcepto").val();
            $("#ClaveProdServCPConceptos").html("");
            $("#ClaveUnidadConceptoConceptos_ClavesProdServ").html("");
            cambioImpRet();
            cambioImpTras();

            consultaConcepto(ConceptosClaveProd);
        });

        $("#confDelete").on('click', function () {
            let text = "¿seguro que deseas eliminarlo?";
            if (confirm(text) == false) {
                window.location.href = "../Index";
            }
        });
        function borrarConceptos() {
            //eliminar los conceptos ya agregados
            $(".conceptos").parent().remove();
            $(".contadorConceptos").replaceWith('<span class="contadorConceptos font-blue">: 0</span >');
            cambioImpRet();
            cambioImpTras();
            $("#total").val("0");
            $("#subtotal").val("0");
            $("#TTotal").val("0");
            $("#RTotal").val("0");
        }
        function consultaConcepto(concepto) {

            if (concepto != "") {
                $.get("/ComplementosCartaPorte/DatosCatalogoConceptos", { claveProd: concepto }, function (data) {
                    if (data.length > 0) {
                        $.each(data, function (index, row) {
                            $("#Conceptos_ClavesProdServ").val(row.ClavesProdServ);
                            $("#Conceptos_ClavesUnidad").val(row.ClavesUnidad);
                            $("#Conceptos_Unidad").val(row.Unidad);
                            $("#Conceptos_Descripcion").val(row.Descripcion);
                            $("#Conceptos_NoIdentificacion").val(row.NoIdentificacion);
                            $("#Conceptos_Cantidad").val(row.Cantidad);
                            $("#Conceptos_ValorUnitario").val(row.ValorUnitario);
                            $("#Conceptos_Importe").val(row.Importe);
                            $("#Descuento").val(row.Descuento);

                            if ($("#tipoComprobante").val() == "I") {

                                $("#Conceptos_ObjetoImpuesto").val(row.ObjetoImpuesto);
                                if (row.ImpuestoIdTras != null) {
                                    var ImpuestoT = row.ImpuestoIdTras;
                                    agregarImpuestos(ImpuestoT);
                                } else {
                                    cambioImpTras();
                                }
                                if (row.ImpuestoIdRet != null) {
                                    var ImpuestoT = row.ImpuestoIdRet;
                                    agregarImpuestos(ImpuestoT);
                                } else {
                                    cambioImpRet();
                                }
                            }
                            else {

                                $("#Conceptos_ObjetoImpuesto").val("01");
                                $('.objetoImpuestoText').text("01-No objeto de impuesto");
                                cambioImpTras();
                                cambioImpRet();
                            }
                        });
                    }
                });
            }
        }
        function cambioImpRet() {
            $("#RBase").val("0");
            $("#Conceptos_Retencion_Impuesto").val("001").change();;
            $("#Conceptos_Retencion_TipoFactor").val("Tasa").change();;
            $("#RTasaOCuota").val("0.00");
            $("#RImporte").val("0");
            $("#RTotal").val("0");

        }
        function cambioImpTras() {
            $("#TBase").val("0");
            $("#Conceptos_Traslado_Impuesto").val("001").change();
            $("#Conceptos_Traslado_TipoFactor").val("Tasa").change();;
            $("#TTasaOCuota").val("0.00");
            $("#TImporte").val("0");
            $("#TTotal").val("0");
        }

        $('#CImpuestoT').change(function () {
            var ImpuestoT = $(this).val();
            agregarImpuestos(ImpuestoT);
        });
        $('#CImpuestoR').change(function () {
            var ImpuestoT = $(this).val();
            agregarImpuestos(ImpuestoT);
        });
        $("#Conceptos_Importe").change(function () {
            //Retencion
            cambioimporte();
        });

    });






    function cambioimporte() {

        $("#RBase").val(($("#RBaseP").val() * $("#Conceptos_Importe").val()) / 100);
        var RBase = parseFloat($('#RBase').val());
        var RTasaOCuota = parseFloat($('#RTasaOCuota').val());
        if ($('#RBase').val() === "") {
            RBase = 0;

        }
        if ($('#RTasaOCuota').val() === "") {
            RTasaOCuota = 0;
        }

        var TotalRet = (RBase * RTasaOCuota);

        $('#RImporte').val(TotalRet);

        //traslado
        $("#TBase").val(($("#TBaseP").val() * $("#Conceptos_Importe").val()) / 100);
        var TBase = parseFloat($('#TBase').val());
        var TTasaOCuota = parseFloat($('#TTasaOCuota').val());
        if ($('#TBase').val() === "") {
            TBase = 0;

        }
        if ($('#TTasaOCuota').val() === "") {
            TTasaOCuota = 0;
        }

        var TotalTras = (TBase * TTasaOCuota);
        $('#TImporte').val(TotalTras);
    }

    function agregarImpuestos(ImpuestoT) {

        var TipoImpuesto = "";
        var base = "";
        var basePor = "";
        var TImpuesto = "";
        var TipoFactor = "";
        var TasaCuota = "";
        var Importe = "";
        if (ImpuestoT != "") {
            $.get("/ComplementosCartaPorte/DatosCatalogoImpuesto", { IdImpuesto: ImpuestoT }, function (data) {

                if (data.length > 0) {
                    $.each(data, function (index, row) {
                        TipoImpuesto = row.TipoImpuesto;
                        base = (row.Base * $("#Conceptos_Importe").val()/100);

                        basePor = row.Base;
                        TImpuesto = row.Impuesto;
                        TipoFactor = row.TipoFactor;
                        TasaCuota = row.TasaOCuota;
                        Importe = (base * TasaCuota);
                    });

                    if (TipoFactor == 0) {
                        TipoFactor = "Tasa";
                    } else if (TipoFactor == 1) {
                        TipoFactor = "Cuota";

                    } else if (TipoFactor == 2) {
                        TipoFactor = "Exento";
                    }

                    if (TImpuesto == 1) {
                        TImpuesto = "001";
                    } else if (TImpuesto == 2) {
                        TImpuesto = "002";

                    } else if (TImpuesto == 3) {
                        TImpuesto = "003";
                    }
                    //$("#Conceptos_Traslado_Impuesto").val("002").change();

                    if (TipoImpuesto === "Traslado") {
                        bT = base;
                        $("#TBaseP").val(basePor);
                        $("#TBase").val(base);
                        $("#Conceptos_Traslado_Impuesto").val(TImpuesto).change();
                        $("#Conceptos_Traslado_TipoFactor").val(TipoFactor).change();
                        $("#TTasaOCuota").val(TasaCuota);
                        $("#TImporte").val(Importe);
                        //$("#TTotal").val(totalImporteT);

                    } else {
                        bR = base;
                        $("#RBaseP").val(basePor);
                        $("#RBase").val(base);
                        $("#Conceptos_Retencion_Impuesto").val(TImpuesto).change();
                        $("#Conceptos_Retencion_TipoFactor").val(TipoFactor).change();
                        $("#RTasaOCuota").val(TasaCuota);
                        $("#RImporte").val(Importe);
                        //$("#RTotal").val(totalImporteR);
                    }
                    //cambioimporte();

                } else {
                    $("#TBaseP").val("0");
                    $("#TBase").val("0");
                    $("#Conceptos_Traslado_Impuesto").val("0");
                    $("#Conceptos_Traslado_TipoFactor").val("0");
                    $("#TTasaOCuota").val("0");
                    $("#TImporte").val("0");
                }




            });
        }
    }
    $(function () {
        $('#Conceptos_ValorUnitario').on("keyup", function () {
            calculo();
            if ($("#tipoComprobante").val() == "I") {
                cambioimporte();
            }
        });
        $('#Conceptos_Cantidad').on("keyup", function () {
            calculo();
            if ($("#tipoComprobante").val() == "I") {
                cambioimporte();
            }
        });
        function calculo() {
            var multi = 0;
            var cantidad = 0;

            var precio = 0;
            precio = cero($("#Conceptos_ValorUnitario").val());
            cantidad = cero($("#Conceptos_Cantidad").val());
            multi = cantidad * precio;

            $("#Conceptos_Importe").val(multi);
        }

        function cero(valor) {
            if (valor == "" || valor == "undefined") {
                return valor = 0;
            } else {
                return parseFloat(valor);
            }
        }

        $('#TBaseP').on("keyup", function () {

            cambioimporte();
        });
        $('#TBaseP').change(function () {

            cambioimporte();
        });
        $('#RBaseP').on("keyup", function () {

            cambioimporte();
        });
        $('#RBaseP').change(function () {

            cambioimporte();
        });

    });


    ///cambios lalo
    $(function () {
        $("#tipoComprobante").change(function () {
            if ($(this).val() === "T") {
                var idCliente = $("#IDCliente").val();

                $('#ReceptorId').val(String(idCliente));
                $('#UsoCfdiCP').val("S01");
                //

                $('#recep').text($('#ReceptorId option:selected').text());
                $('#usoCfdiCP').text($('#UsoCfdiCP option:selected').text());
                //
                $('#ReceptorId').val(idCliente);
                $('#UsoCfdiCP').val('S01')
                //
                $('#receptorDrop').hide();
                $('#receptorText').show();
                $('.InformacionReceptor').text('Al ser un CFDi de tipo T de Traslado, el RFC del Receptor tiene que ser el mismo del Emisor.');
                $('#activaObjetoImpI').hide();
                $('#activaObjetoImpT').show();
                $("#Conceptos_ObjetoImpuesto").val("01");
                $('#objetoImpuestoText').text("01-No objeto de impuesto");
                //var receptorSeleccionado = $('#ReceptorId').val();
                //drowdop(receptorSeleccionado);
            }
            if ($(this).val() === "I") {

                $('#ReceptorId').val(1);
                $('#UsoCfdiCP').val(1);
                $('#receptorDrop').show();
                $('#receptorText').hide();
                $('.InformacionReceptor').text('');
                $('#activaObjetoImpI').show();
                $('#activaObjetoImpT').hide();

            }
        });
    });
    $(function () {
        tippy('#TipoCambio', {
            content: 'Si la moneda es diferente de MXN asegúrate de actualizar el Tipo de Cambio',
        });
        tippy('#Mercancias_Mercancia_Dimensiones', {
            content: 'Esribe las dimensiones en cm o in. Ejemplo: Dimensiones= 30/40/30cm',
        });
    });

    //Funciones pestaña Comprobante
    $("#Moneda").change(function () {
        if ($(this).val() === "MXN") {
            /*$('#subtotal').attr("disabled", "disabled")*/
            $('#TipoCambio').val("1");

            //$('#claveTransporte').val("0.00");
            $('#subtotal').val("0.00");
            $('#total').val("0.00");
        } else {

        }
    });
    $(function () {
        $('#TiposFigura_RFCFigura').on('keyup', function () {
            var rfcFigura = $('#TiposFigura_RFCFigura').val();
            if (rfcFigura === "XEXX010101000") {
                $('.rfcExtranjero').show();

            } else {
                $('.rfcExtranjero').hide();
            }
        });
    });

    $(function () {
        $(".espacio").on('keyup', function () {
            var key = $(this).attr("id");
            var text = $("#" + key).val();
            let exp = new RegExp('^ *');

            if (text.match(exp) != null && text.match(exp) != "") {
                $("#" + key).val(text.replace(exp, ""));
            }
            /*if (text == " ") {
                $("#" + key).val("");
            }*/
        });
    });

    //valida RFC
    $(function () {
    $(".rfc").on('keyup', function () {
        var key = $(this).attr("id");
        var text = $("#" + key).val();

        let exp = /\$|#|%|&|"|\)|\(|\/|\?|¿|'|!|¡|=|-|\.|\,|\+|\*|;|:|\s+/g;
        let rfc = /^[A-Z&Ñ]{3,4}[0-9]{2}(0[1-9]|1[012])(0[1-9]|[12][0-9]|3[01])[A-Z0-9]{2}[0-9A]$/;

        if (text.match(rfc) == null || text.match(rfc) == "") {
            $("#Error_" + key).text("Formato de RFC no valido");
        } else {
            $("#Error_" + key).text("");
        }

        if (text.match(exp) != null && text.match(exp) != "") {
            $("#" + key).val(text.replace(exp, ""));
            $("#Error_" + key).text("");
        }
    });

    //valida entrada de texto
    $("#Ubicacion_Domicilio_Calle").on('keyup', function () {
        var key = $(this).attr("id");
        var text = $("#" + key).val();

        let exp = /\$|#|%|&|"|\)|\(|\/|\?|¿|'|!|¡|=+/g;

        if (text.match(exp) != null && text.match(exp) != "") {
            $("#" + key).val(text.replace(exp, ""));
            $("#Error_" + key).text("");
        }

        if (text.length > 100) {
            $("#Error_Calle").text("Se ha excedido el numero de caracteres");
        } else {
            $("#Error_Calle").text("");
        }

    });

        //select load domicilio
        $(".ddlPaisesChange").change(function () {

            var Paises = "#" + $(this).attr('id');
            var Seccion = Paises.replace('Paises', '');

            var ddlEstados = Seccion + "ddlEstados";

            var ddlMunicipios = Seccion + "ddlMunicipios";
            var ddlLocalidades = Seccion + "ddlLocalidades";
            var ddlColonias = Seccion + "ddlColonias";
            var tbEstados = Seccion + "Estado";
            var tbMunicipios = Seccion + "Municipio";
            var tbLocalidades = Seccion + "Localidad";
            var tbColonias = Seccion + "Colonia";
            //asigancion de la misma id inicial
            var idPrincipal = $(this).attr('id');
            var idInicial = idPrincipal.replace('Paises', '');
            //add name id dropdow
            $(".dropdownEstado").attr('id', idInicial + "dEstados");
            $(".dropdownMunicipio").attr('id', idInicial + "dMunicipios");
            $(".dropdownLocalidad").attr('id', idInicial + "dLocalidades");
            $(".dropdownColonia").attr('id', idInicial + "dColonias");

            //get id dropdown
            var divDropdownEstados = "#" + $(".dropdownEstado").attr('id');
            var divDropdownMunicipios = "#" + $(".dropdownMunicipio").attr('id');
            var divDropdownLocalidades = "#" + $(".dropdownLocalidad").attr('id');
            var divDropdownColonias = "#" + $(".dropdownColonia").attr('id');

            //add name id input
            $(".inputEstado").attr('id', idInicial + "iEstado");
            $(".inputMunicipio").attr('id', idInicial + "iMunicipio");
            $(".inputLocalidad").attr('id', idInicial + "iLocalidad");
            $(".inputColonia").attr('id', idInicial + "iColonia");
            //get id input
            var divInputEstados = "#" + $(".inputEstado").attr('id');
            var divInputMunicipios = "#" + $(".inputMunicipio").attr('id');
            var divInputLocalidades = "#" + $(".inputLocalidad").attr('id');
            var divInputColonias = "#" + $(".inputColonia").attr('id');


            if ($(Paises).val() == "MEX" || $(Paises).val() == "USA" || $(Paises).val() == "CAN") {

                $.get("/ComplementosCartaPorte/FiltrarEstados", { PaisId: $(Paises).val() }, function (data) {
                    LimpiartbCamposget($(tbEstados), $(divInputEstados));
                    LimpiartbCamposget($(tbMunicipios), $(divInputMunicipios));
                    LimpiartbCamposget($(tbLocalidades), $(divInputLocalidades));
                    //LimpiartbCamposget($("#tbCodigosPostales"));
                    LimpiartbCamposget($(tbColonias), $(divInputColonias));

                    LimpiarddlCamposget($(ddlEstados), $(divDropdownEstados));
                    LimpiarddlCamposget($(ddlMunicipios), $(divDropdownMunicipios));
                    LimpiarddlCamposget($(ddlLocalidades), $(divDropdownLocalidades));
                    //LimpiarddlCamposget($("#ddlCodigosPostales"));
                    LimpiarddlCamposget($(ddlColonias), $(divDropdownColonias));


                    $(ddlEstados).empty();
                    $(ddlEstados).removeClass('hiddenDiv');


                    $(ddlEstados).append("<option value> Seleccionar Estados de " + $(Paises + " option:selected").text() + "</option>")
                    $.each(data, function (index, row) {
                        $(ddlEstados).append("<option value='" + row.c_Estado + "'>" + row.NombreEstado + "</option>")
                    });
                    $(ddlEstados).removeAttr('disabled');
                    //$(ddlEstados).selectpicker('refresh');
                });
            }
            else {

                LimpiarddlCampos($(ddlEstados), $(divDropdownEstados));
                LimpiartbCampos($(tbEstados), $(divInputEstados));
                LimpiarddlCampos($(ddlMunicipios), $(divDropdownMunicipios));
                LimpiartbCampos($(tbMunicipios), $(divInputMunicipios));
                LimpiarddlCampos($(ddlLocalidades), $(divDropdownLocalidades));
                LimpiartbCampos($(tbLocalidades), $(divInputLocalidades));
                LimpiarddlCampos($(ddlColonias), $(divDropdownColonias));
                LimpiartbCampos($(tbColonias), $(divInputColonias));

                //LimpiarddlCampos($("#ddlCodigosPostales"))
                //LimpiartbCampos($("#tbCodigosPostales"));

            }
        });

        $('.ddlEstadosChange').change(function () {
            var ddlEstados = "#" + $(this).attr('id');
            var Seccion = ddlEstados.replace('ddlEstados', '');
            var Paises = Seccion + "Paises";
            var ddlMunicipios = Seccion + "ddlMunicipios";
            var ddlLocalidades = Seccion + "ddlLocalidades";
            var ddlColonias = Seccion + "ddlColonias";
            var tbEstados = Seccion + "Estado";
            var tbMunicipios = Seccion + "Municipio";
            var tbLocalidades = Seccion + "Localidad";
            var tbColonias = Seccion + "Colonia";
            var tbCodigosPostales = Seccion + "CodigoPostal";

            //asigancion de la misma id inicial
            var idPrincipal = $(this).attr('id');
            var idInicial = idPrincipal.replace('ddlEstados', '');
            //add name id dropdow
            $(".dropdownMunicipio").attr('id', idInicial + "dMunicipios");
            $(".dropdownLocalidad").attr('id', idInicial + "dLocalidades");
            $(".dropdownColonia").attr('id', idInicial + "dColonias");

            //get id dropdown
            var divDropdownMunicipios = "#" + $(".dropdownMunicipio").attr('id');
            var divDropdownLocalidades = "#" + $(".dropdownLocalidad").attr('id');
            var divDropdownColonias = "#" + $(".dropdownColonia").attr('id');

            //add name id input
            $(".inputMunicipio").attr('id', idInicial + "iMunicipio");
            $(".inputLocalidad").attr('id', idInicial + "iLocalidad");
            $(".inputColonia").attr('id', idInicial + "iColonia");
            //get id input
            var divInputMunicipios = "#" + $(".inputMunicipio").attr('id');
            var divInputLocalidades = "#" + $(".inputLocalidad").attr('id');
            var divInputColonias = "#" + $(".inputColonia").attr('id');

            if ($(Paises).val() == "MEX") {
                LimpiartbCamposget($(tbMunicipios), $(divInputMunicipios));
                LimpiartbCamposget($(tbLocalidades), $(divInputLocalidades));
                //LimpiartbCamposget($("#tbCodigosPostales"));
                LimpiartbCamposget($(tbColonias), $(divInputColonias));

                LimpiarddlCamposget($(ddlMunicipios), $(divDropdownMunicipios));
                LimpiarddlCamposget($(ddlLocalidades), $(divDropdownLocalidades));
                //LimpiarddlCamposget($("#ddlCodigosPostales"));
                LimpiarddlCamposget($(ddlColonias), $(divDropdownColonias));
                $.get("/ComplementosCartaPorte/FiltrarMunicipios", { EstadoId: $(ddlEstados).val() }, function (data) {
                    $(ddlMunicipios).empty();
                    //$("#ddlMunicipios").removeClass('hidden');

                    //$("#ddlMunicipios").append("<option value> Seleccionar Municipio de " + $("#ddlEstado option:selected").text() + "</option>")
                    $.each(data, function (index, row) {
                        $(ddlMunicipios).append("<option value='" + row.c_Municipio + "'>" + row.Descripcion + "</option>")
                    });
                    $(ddlMunicipios).removeAttr('disabled');
                    //$(ddlMunicipios).selectpicker('refresh');
                });
                $.get("/ComplementosCartaPorte/FiltrarLocalidades", { EstadoId: $(ddlEstados).val() }, function (data) {

                    $(ddlLocalidades).empty();
                    $(ddlLocalidades).append("<option value> Ninguno</option>")
                    $.each(data, function (index, row) {
                        $(ddlLocalidades).append("<option value='" + row.c_Localidad + "'>" + row.Descripcion + "</option>")
                    });
                    $(ddlLocalidades).removeAttr('disabled');
                    //$(ddlLocalidades).selectpicker('refresh');
                });
            }
            else {
                LimpiarddlCampos($(ddlMunicipios), $(divDropdownMunicipios));
                LimpiartbCampos($(tbMunicipios), $(divInputMunicipios));
                LimpiarddlCampos($(ddlLocalidades), $(divDropdownLocalidades));
                LimpiartbCampos($(tbLocalidades), $(divInputLocalidades));
                //LimpiarddlCampos($("#ddlCodigosPostales"))
                //LimpiartbCampos($(tbCodigosPostales));
                LimpiarddlCampos($(ddlColonias), $(divDropdownColonias))
                LimpiartbCampos($(tbColonias), $(divInputColonias));
            }
        });

        $('.CodigosPostalesChange').keyup(function (e) {
            let timeout = null;
            clearTimeout(timeout);
            var tbCodigosPostales =  "#" + $(this).attr('id');
            var Seccion = tbCodigosPostales.replace('CodigoPostal', '');
            var Paises = Seccion + "Paises";
            var ddlColonias = Seccion + "ddlColonias";

            //asigancion de la misma id inicial
            var idPrincipal = $(this).attr('id');
            var idInicial = idPrincipal.replace('CodigoPostal', '');
            //add name id dropdow
            $(".dropdownColonia").attr('id', idInicial + "dColonias");

            //get id dropdown
            var divDropdownColonias = "#" + $(".dropdownColonia").attr('id');


            // Make a new timeout set to go off in 1000ms (1 second)
            timeout = setTimeout(function () {
                if ($(Paises).val() == "MEX") {
                    $.get("/ComplementosCartaPorte/FiltrarColonias", { CodigoPostalId: $(tbCodigosPostales).val() }, function (data) {
                        $(ddlColonias).empty();
                        $.each(data, function (index, row) {
                            $(ddlColonias).append("<option value='" + row.c_Colonia + "'>" + row.Nombreasentamiento + "</option>")
                        });
                        $(ddlColonias).removeAttr('disabled');

                        //$(ddlColonias).selectpicker('refresh');
                    });
                }
                else {

                }
            }, 1000);

        });

        function LimpiartbCamposget(tb, divInput) {
            tb.val('');
            tb.addClass('hiddenDiv');
            divInput.addClass('hiddenDiv');
            //tb.selectpicker('refresh');
        }

        function LimpiarddlCamposget(ddl ,divDropdown) {
            ddl.empty();
            ddl.attr('disabled', 'disabled');
            ddl.removeClass('hiddenDiv');
            ddl.parent().removeClass("hiddenDiv");
            divDropdown.removeClass('hiddenDiv');

            //ddl.parent().attr("disabled", "disabled");
           // ddl.selectpicker('refresh');
        }

        function LimpiartbCampos(tb,divInput) {
            tb.val('');
            tb.removeClass('hiddenDiv');
            nombre = tb.attr('name');
            tb.attr('placeholder', 'Ingrese ' + nombre);
            divInput.removeClass('hiddenDiv');
            //tb.attr("placeholder", "Ingrese " + nombre + " del municipio de " + $("#ddlPaises option:selected").text());
            //tb.selectpicker('refresh');
        }

        function LimpiarddlCampos(ddl,divDropdown) {
            ddl.empty();
            ddl.attr('disabled', 'disabled');
            ddl.addClass('hiddenDiv');
            divDropdown.addClass('hiddenDiv');

        }

    });
    $(function () {
        $('.cfdiRelacionado').change(function () {
            if ($('.cfdiRelacionado').prop('checked')) {
                $('.cfdiRelacionadoSeccion').show(200);
                $('.cfdiRelacionadoSeccion').css('display', 'inline');
            } else {
                $('.cfdiRelacionadoSeccion').hide(200);
            }
        });

        //Detalle Ubicaciones
    $('#agregarDetalleUbicacion').click(function () {

        var contador = $(".ubicacion").length + 1;
            $(".contadorUbicaciones").replaceWith('<span class="contadorUbicaciones font-blue">: ' + contador + '</span >');

    });




    $("#agregarDetalleUbicacion").on('click', function () {
        var TU = false;
        var RR = false;
        var FHS = false;
        var P = false;
        var E = false;
        var CP = false;
        var message;
        var ORTipoUbicacion = $('#TipoUbicacionRD').val();
            message ="#TipoUbicacion"
            TU = Boolean(ValidaCampos(ORTipoUbicacion,message));
        var ORRFCRemitente = $('#Ubicacion_RfcRemitenteDestinatario').val();
            message = "#RfcRemitente"
            RR = Boolean(ValidaCampos(ORRFCRemitente, message));
        var FechaHoraSalida = $('#Ubicacion_FechaHoraSalidaLlegada').val();

            message="#FechaHoraSalida"
        FHS = Boolean(ValidaCampos(FechaHoraSalida, message));
        var ORPais = $("#Ubicacion_Domicilio_Paises").val();
        message = "#UPais"
        var ORPaisText = $("#Ubicacion_Domicilio_Paises option:selected").text();

        P = Boolean(ValidaCampos(ORPais, message));
        //se toman valores de  campos de select o input
        var OREstado = $('#Ubicacion_Domicilio_ddlEstados option:selected').val();
        var OREstadoText = $('#Ubicacion_Domicilio_ddlEstados option:selected').text();
        message = "#UEstado"
        E = Boolean(ValidaCampos(OREstado, message));
        if (!E) {
            OREstado = $('#Ubicacion_Domicilio_Estado').val();
            OREstadoText = OREstado;
            message = "#UEstado"
            E = Boolean(ValidaCampos(OREstado, message));
        }

        var DEMunicipio = $('#Ubicacion_Domicilio_ddlMunicipios option:selected').val();
        var DEMunicipioText = $('#Ubicacion_Domicilio_ddlMunicipios option:selected').text();
        message = ""
        var ddlM = Boolean(ValidaCampos(DEMunicipio, message));
        if (!ddlM) {
            DEMunicipio = $('#Ubicacion_Domicilio_Municipio').val();
            DEMunicipioText = DEMunicipio;
        }
        var DELocalidad = $('#Ubicacion_Domicilio_ddlLocalidades option:selected').val();
        var DELocalidadText = $('#Ubicacion_Domicilio_ddlLocalidades option:selected').text();
        message = ""
        var ddlL = Boolean(ValidaCamposVaciosUbicacionDomicilio(DELocalidad, message));
        if (!ddlL) {
            DELocalidad = $('#Ubicacion_Domicilio_Localidad').val();
            DELocalidadText = DELocalidad;
        }
        var DEColonia = $('#Ubicacion_Domicilio_ddlColonias option:selected').val();
        var DEColoniaText = $('#Ubicacion_Domicilio_ddlColonias option:selected').text();
        message = ""
        var ddlC = Boolean(ValidaCampos(DEColonia, message));
        if (!ddlC) {
            DEColonia = $('#Ubicacion_Domicilio_Colonia').val();
            DEColoniaText = DEColonia;
        }
        //
        var ORCodigoPostal = $('#Ubicacion_Domicilio_CodigoPostal').val();
            message = "#UCodigoPostal"
            CP = Boolean(ValidaCampos(ORCodigoPostal, message));
        if (!RR || !TU || !FHS || !E || !CP || !P) {

        } else {


        var ORNE = "";
        var NumEsta = "";
            if ($("#DivEstacionMaritimo").is(":visible")) {
                ORNE = $('#NombreEstacionMaritimo option:selected').text();
                NumEsta = $('#NombreEstacionMaritimo option:selected').val();
        }
        if ($("#DivEstacionAereo").is(":visible")) {
            ORNE = $('#NombreEstacionAereo option:selected').text();
            NumEsta = $('#NombreEstacionAereo option:selected').val();

        }
            if ($("#DivEstacionFerroviario").is(":visible")) {
                ORNE = $('#NombreEstacionFerroviario option:selected').text();
                NumEsta = $('#NombreEstacionFerroviario option:selected').val();

            }
            var clave="";
            var randomClave = Math.floor(100000 + Math.random() * 900000);
            if ($('#TipoUbicacionRD').val() === "Origen") { clave = "OR" + randomClave; } else { clave = "DE" + randomClave }
        $.ajax({
            type: 'POST',
            url: ' @Url.Action("AgregarUbicacion", "AjaxOperaciones")',
            data: JSON.stringify({
                TipoUbicacion: $('#TipoUbicacionRD').val(),
                TipoEstacion: $('#UTipoEstacion option:selected').text(),
                TipoEstacionId: $('#UTipoEstacion option:selected').val(),//id =Ubicacion_ORTipoEstacion
                IdUbicacion: $('#Ubicacion_IDUbicacion').val(),
                RFCRemitenteDestinatario: $('#Ubicacion_RfcRemitenteDestinatario').val(),
                NombreRemitenteDestinatario: $('#Ubicacion_NombreRemitenteDestinatario').val(),
                NumRegIdTrib: $('#Ubicacion_NumRegIdTrib').val(),
                ResidenciaFiscal: $('#Ubicacion_ResidenciaFiscal').val(),
                NombreEstacion: ORNE,
                NumEstacion: NumEsta,
                NavegacionTrafico: $('#Ubicacion_NavegacionTrafico').val(),
                FechaHoraSalidaLlegada: $('#Ubicacion_FechaHoraSalidaLlegada').val(),
                DistanciaRecorrida: $('#DistanciaRO').val(),
                Calle: $('#Ubicacion_Domicilio_Calle').val(),
                CodigoPostal: $('#Ubicacion_Domicilio_CodigoPostal').val(),
                Colonia: DEColonia,
                ColoniaText: DEColoniaText,
                Estado: OREstado,
                EstadoText: OREstadoText,
                Localidad: DELocalidad,
                LocalidadText: DELocalidadText,
                Municipio: DEMunicipio,
                MunicipioText: DEMunicipioText,
                NumeroExterior: $('#Ubicacion_Domicilio_NumeroExterior').val(),
                NumeroInterior: $('#Ubicacion_Domicilio_NumeroInterior').val(),
                Pais: ORPais,
                PaisText: ORPaisText,
                Referencia: $('#Ubicacion_Domicilio_Referencia').val()
            }),
            dataType: 'html',
            contentType: "application/json; charset=utf-8",
            success: function (partialView) {
                $('#Ubicacion_IDUbicacion').val(clave);
                $('#detalleUbicaciones').append(partialView);
            },
            error: function (jqxhr, textStatus, error) {
                alert("Favor de llenar todos los datos para los detalles");
            }
           });
        return false;
        }
    });

        $('#claveTransporteId').change(function () {
            var ClaveTransporteId = $(this).val();

            switch (ClaveTransporteId) {
                case "02":
                    $('#DivEstacionMaritimo').show();
                    $('#DivEstacionAereo').hide();
                    $('#DivEstacionFerroviario').hide();
                    $('#DivNumEstacion').show();
                    $('#NumEstacion').val('');
                    $('#DivEstacionMaritimoD').show();
                    $('#DivEstacionAereoD').hide();
                    $('#DivEstacionFerroviarioD').hide();
                    $('#DivNumEstacionD').show();
                    $('#NumEstacionD').val('');
                    $('#TransporteMaritimo').show();
                    $('#TransporteAereo').hide();
                    $('#TransporteFerroviario').hide();
                    $('#DivAutotransporte').hide();
                    $('#TotalDistRec').hide();
                    $('.activaTipoEstacion').show();
                    $('#ActivaDimensiones').hide();
                    $('#DivNavegacionTrafico').show();
                    $('#activaMercPeso').show();
                    //$('.DivDetalleMercancia').show();
                    $('#DivCargoTasacion').hide();
                    //$(".pesoBrutoTotalD").attr('disabled', 'disabled');
                    $(".activaClaveSTCC").hide();
                    // $('.DivCantidadTransportada').hide(200);
                    break;
                case "03":
                    $('#DivEstacionMaritimo').hide();
                    $('#DivEstacionAereo').show();
                    $('#DivEstacionFerroviario').hide();
                    $('#DivNumEstacion').show();
                    $('#NumEstacion').val('');
                    $('#DivEstacionMaritimoD').hide();
                    $('#DivEstacionAereoD').show();
                    $('#DivEstacionFerroviarioD').hide();
                    $('#DivNumEstacionD').show();
                    $('#NumEstacionD').val('');
                    $('#TransporteAereo').show();
                    $('#TransporteMaritimo').hide();
                    $('#TransporteFerroviario').hide();
                    $('#DivAutotransporte').hide();
                    $('#TotalDistRec').hide();
                    $('.activaTipoEstacion').show();
                    $('#ActivaDimensiones').show();
                    $('#DivNavegacionTrafico').hide();
                    $('#activaMercPeso').hide();
                    // $('.DivDetalleMercancia').hide();
                    $('#DivCargoTasacion').show();
                    //$(".pesoBrutoTotalD").removeAttr('disabled');
                    $(".activaClaveSTCC").hide();
                    break;
                case "04":
                    $('#DivEstacionMaritimo').hide();
                    $('#DivEstacionAereo').hide();
                    $('#DivEstacionFerroviario').show();
                    $('#DivNumEstacion').show();
                    $('#NumEstacion').val('');
                    $('#DivEstacionMaritimoD').hide();
                    $('#DivEstacionAereoD').hide();
                    $('#DivEstacionFerroviarioD').show();
                    $('#DivNumEstacionD').show();
                    $('#NumEstacionD').val('');
                    $('#TransporteFerroviario').show();
                    $('#TransporteMaritimo').hide();
                    $('#TransporteAereo').hide();
                    $('#DivAutotransporte').hide();
                    $('#TotalDistRec').show();
                    $('.activaTipoEstacion').show();
                    $('#ActivaDimensiones').hide();
                    $('#DivNavegacionTrafico').hide();
                    $('#activaMercPeso').show();
                    // $('.DivDetalleMercancia').show();
                    $('#DivCargoTasacion').hide();
                    // $(".pesoBrutoTotalD").attr('disabled', 'disabled');
                    $(".activaClaveSTCC").show();
                    //$('.DivCantidadTransportada').show();
                    break;
                case "05":
                    $('#DivEstacionMaritimo').hide();
                    $('#DivEstacionAereo').hide();
                    $('#DivEstacionFerroviario').hide();
                    $('#DivNumEstacion').hide();
                    $('#NumEstacion').val('');
                    $('#DivEstacionMaritimoD').hide();
                    $('#DivEstacionAereoD').hide();
                    $('#DivEstacionFerroviarioD').hide();
                    $('#DivNumEstacionD').hide();
                    $('#NumEstacionD').val('');
                    $('#TransporteFerroviario').hide();
                    $('#TransporteMaritimo').hide();
                    $('#TransporteAereo').hide();
                    $('#DivAutotransporte').hide();
                    $('#TotalDistRec').hide();
                    $('.activaTipoEstacion').hide();
                    $('#ActivaDimensiones').hide();
                    $('#DivNavegacionTrafico').hide();
                    $('#activaMercPeso').hide();
                    //$('.DivDetalleMercancia').hide();
                    $('#DivCargoTasacion').hide();
                    //$(".pesoBrutoTotalD").attr('disabled', 'disabled');
                    $(".activaClaveSTCC").hide();
                    //$('.DivCantidadTransportada').hide();
                    break;
                default:
                    $('#DivEstacionMaritimo').hide();
                    $('#DivEstacionAereo').hide();
                    $('#DivEstacionFerroviario').hide();
                    $('#DivNumEstacion').hide();
                    $('#NumEstacion').val('');
                    $('#DivEstacionMaritimoD').hide();
                    $('#DivEstacionAereoD').hide();
                    $('#DivEstacionFerroviarioD').hide();
                    $('#DivNumEstacionD').hide();
                    $('#NumEstacionD').val('');
                    $('#DivAutotransporte').show();
                    $('#TransporteMaritimo').hide();
                    $('#TransporteAereo').hide();
                    $('#TransporteFerroviario').hide();
                    $('#TotalDistRec').show();
                    $('.activaTipoEstacion').hide();
                    $('#ActivaDimensiones').show();
                    $('#DivNavegacionTrafico').hide();
                    $('#activaMercPeso').hide();
                    //$('.DivDetalleMercancia').hide();
                    $('#DivCargoTasacion').hide();
                    //$(".pesoBrutoTotalD").removeAttr('disabled');
                    $(".activaClaveSTCC").hide();
            }

        });

        $('#ReceptorId').change(function () {
            var ReceptorId = $(this).val();
            $.get("/ComplementosCartaPorte/DatosCliente", { ClienteId: ReceptorId }, function (data) {
                $.each(data, function (index, row) {
                    $("#Ubicacion_UbicacionDestino_RfcDestinatario").val(row.Item1)
                        * $('#Ubicacion_UbicacionDestino_RfcDestinatario').attr("disabled", "disabled")
                    $("#Ubicacion_UbicacionDestino_NombreDestinatario").val(row.Item2)
                        * $('#Ubicacion_UbicacionDestino_NombreDestinatario').attr("disabled", "disabled")
                    $("#Ubicacion_UbicacionDestino_ResidenciaFiscal").val(row.Item3)
                        * $('#Ubicacion_UbicacionDestino_ResidenciaFiscal').attr("disabled", "disabled")
                });
            });
        });

        $('.NombreEstacion').change(function () {
            var ClaveEstacion = $(this).val();
            $('#NumEstacion').val(ClaveEstacion);
        });

        $('.NombreEstacionD').change(function () {
            var ClaveEstacion = $(this).val();
            $('#NumEstacionD').val(ClaveEstacion);
        });

        //valida tipo de ubicación
        $('#TipoUbicacionRD').change(function () {
            var TipoUbicacionRD = $(this).val();
            var clave = "";
            var randomClave = Math.floor(100000 + Math.random() * 900000);

            if (TipoUbicacionRD == "Origen") {
                $('.origenTitulo').show(200);
                $('.origenDomicilio').show(200);
                $('.destinoTitulo').hide(200);
                $('.destinoDomicilio').hide(200);
                $('#Ubicacion_IDUbicacion').val("OR");
                $('.activaDR').hide(200);
                clave = "OR" + randomClave;
                $('#Ubicacion_IDUbicacion').val(clave);
            } else {
                $('.destinoTitulo').show(200);
                $('.destinoDomicilio').show(200);
                $('.origenTitulo').hide(200);
                $('.origenDomicilio').hide(200);
                $('#Ubicacion_IDUbicacion').val("DE");
                $('.activaDR').show(200);
                clave = "DE" + randomClave
                $('#Ubicacion_IDUbicacion').val(clave);
            }

        });




        //Activa campos RFC extranjero
        $('#Ubicacion_RfcRemitenteDestinatario').on("keyup", function () {
            if ($('#Ubicacion_RfcRemitenteDestinatario').val() === "XEXX010101000") {
                $('.activaCamposRFCExtranjero').show(200);
            } else {
                $('.activaCamposRFCExtranjero').hide(200);
            }
        });

        //vista de carta porte vertical
        // Stepper lement
        var element = document.querySelector("#kt_stepper_example_vertical");

        // Initialize Stepper
        var stepper = new KTStepper(element);

        // Handle next step
        stepper.on("kt.stepper.next", function (stepper) {
            stepper.goNext(); // go next step
        });

        // Handle previous step
        stepper.on("kt.stepper.previous", function (stepper) {
            stepper.goPrevious(); // go previous step
        });

    });




    // Carga XML- Agregar Detalles - Kevin Mauricio
    $(document).ready(function agregar() {

        // Manejar el evento submit del botón "Cargar XML"
        $('#myForm').submit(function (event) {

            event.preventDefault();
            var fileInput = $('input[type="file"]')[0];
            var file = fileInput.files[0];
            var formData = new FormData();
            formData.append('Archivo', file);

            $.ajax({
                url: '/ComplementosCartaPorte/ObtenerDatosXML',
                type: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) {
                    //Seccion Comprobante
                    // Rellenar los campos de la vista con los valores obtenidos del XML
                    $('#FechaDocumento').val(new Date(response.Fecha).toLocaleDateString());
                    var fechaCompleta = response.Fecha; // Fecha y hora completa
                    var fecha = new Date(fechaCompleta); // Convierte a objeto de fecha
                    var horas = fecha.getHours(); // Obtener la hora
                    var minutos = fecha.getMinutes(); // Obtener los minutos
                    $('#Hora').val(horas + ':' + minutos); // Mostrar hora y minutos separados por ":" en el elemento con el id "hora"

                    // Convierte el valor del enum a una cadena legible para TipoComprobante
                    var tipoComprobanteText = '';
                    switch (response.TipoDeComprobante) {
                        case 0:
                            tipoComprobanteText = 'I';
                            break;
                        case 1:
                            tipoComprobanteText = 'E';
                            break;
                        case 2:
                            tipoComprobanteText = 'T';
                            break;
                        case 3:
                            tipoComprobanteText = 'N';
                            break;
                        case 4:
                            tipoComprobanteText = 'P';
                            break;
                        // Agrega más casos según los valores de tu enum
                        default:
                            tipoComprobanteText = 'Valor desconocido';
                            break;
                    }

                    $('#tipoComprobante').val(tipoComprobanteText);


                    if (tipoComprobanteText == "T") {

                        //Ocultar campos en Comprobante
                        $('#validaTipoComprobante').hide();


                        //Seccion Receptor y Conceptos
                        var idCliente = $("#IDCliente").val();

                        $('#ReceptorId').val(String(idCliente));
                        $('#UsoCfdiCP').val("S01");
                        //

                        $('#recep').text($('#ReceptorId option:selected').text());
                        $('#usoCfdiCP').text($('#UsoCfdiCP option:selected').text());
                        //
                        $('#ReceptorId').val(idCliente);
                        $('#UsoCfdiCP').val('S01')
                        //
                        $('#receptorDrop').hide();
                        $('#receptorText').show();
                        $('.InformacionReceptor').text('Al ser un CFDi de tipo T de Traslado, el RFC del Receptor tiene que ser el mismo del Emisor.');
                        $('#activaObjetoImpI').hide();
                        $('#activaObjetoImpT').show();
                        $("#Conceptos_ObjetoImpuesto").val("01");
                        $('#objetoImpuestoText').text("01-No objeto de impuesto");


                    }

                    $('#FormaPago').val(response.FormaPago).toString();
                    $('#FormaPago').trigger('change');//Selecciona el valor en el buscador

                    // Convierte el valor del enum a una cadena legible para MetodoPago
                    var MetodoPagoText = '';
                    switch (response.MetodoPago) {
                        case 0:
                            MetodoPagoText = 'PUE';
                            break;
                        case 1:
                            MetodoPagoText = 'PPD';
                            break;

                        // Agrega más casos según los valores de tu enum
                        default:
                            MetodoPagoText = 'Valor desconocido';
                            break;
                    }

                    $('#MetodoPago').val(MetodoPagoText);
                    $('#TipoCambio').val(response.TipoCambio);
                    $('#CondicionesPago').val(response.CondicionesDePago);
                    $('#Moneda').val(response.Moneda);
                    // Activar la selección con Select2
                    $('#Moneda').trigger('change');
                    $('#subtotal').val(response.SubTotal);
                    $('#total').val(response.Total);

                    //Seccion Ubicacion
                    //$('#claveTransporteId').val();


                    $('#TranspInternac').val(response.CartaPorte.TranspInternac);
                    $('#TotalDistRecorridas').val(response.CartaPorte.TotalDistRec);

                    //Seccion Mercancias
                    //$('#pesoBrutoTotalD').val(response.CartaPorte.Mercancias.PesoBrutoTotal); -Dejo que se calcule solo por que duplica el valor
                    $('#Mercancias_ClaveUnidadPeso_Id').val(response.CartaPorte.Mercancias.UnidadPeso);
                    $('#Mercancias_NumTotalMercancias').val(response.CartaPorte.Mercancias.NumTotalMercancias);

                    //Mercancia - Autotransporte
                    $('#Mercancias_AutoTransporte_TipoPermiso_Id').val(response.CartaPorte.Mercancias.Autotransporte.PermSCT);

                    //Validacion si hay valor en la seccion de Auto Transporte
                    var permisoValue = $('#Mercancias_AutoTransporte_TipoPermiso_Id').val();

                    // Verificar si el valor de permisoValue no está vacío o nulo
                    if (permisoValue) {

                        // Si tiene un valor, asignar "01" al elemento con id "claveTransporteId"
                        $('#claveTransporteId').val("01");

                        // Mostrar la vista que estaba oculta
                        $('#DivAutotransporte').css('display', 'block');
                    }

                    $('#Mercancias_AutoTransporte_NumPermisoSCT').val(response.CartaPorte.Mercancias.Autotransporte.NumPermisoSCT);

                    $('#Mercancias_AutoTransporte_IdentificacionVehicular_ConfigAutotransporte_Id').val(response.CartaPorte.Mercancias.Autotransporte.IdentificacionVehicular.ConfigVehicular)
                    $('#Mercancias_AutoTransporte_IdentificacionVehicular_PlacaVM').val(response.CartaPorte.Mercancias.Autotransporte.IdentificacionVehicular.PlacaVM)
                    $('#Mercancias_AutoTransporte_IdentificacionVehicular_AnioModeloVM').val(response.CartaPorte.Mercancias.Autotransporte.IdentificacionVehicular.AnioModeloVM)

                    //Mercancia - Seguros
                    $('#Mercancias_AutoTransporte_Seguros_AseguraRespCivil').val(response.CartaPorte.Mercancias.Autotransporte.Seguros.AseguraRespCivil);
                    $('#Mercancias_AutoTransporte_Seguros_PolizaRespCivil').val(response.CartaPorte.Mercancias.Autotransporte.Seguros.PolizaRespCivil);
                    $('#Mercancias_AutoTransporte_Seguros_PrimaSeguro').val(response.CartaPorte.Mercancias.Autotransporte.Seguros.PrimaSeguro);

                    // Llamar a la función para agregar Complemento Carta Porte
                    $.each(response.CartaPorte.Ubicaciones, function (index, carta) {


                        $.each(response.CartaPorte.Mercancias.Mercancia, function (index, mer) {


                            $.each(response.CartaPorte.Ubicaciones, function (index, carta) {
                                $('#TipoUbicacionRD').val(carta.TipoUbicacion);


                              //Validacion para ubicacion cuando viene vacio, se le asigna una nueva IDUbicacion

                               var IDubi = carta.IDUbicacion;

                                if (IDubi) {

                                    $('#Ubicacion_IDUbicacion').val(carta.IDUbicacion);

                                } else {

                                    var clave = "";
                                    var randomClave = Math.floor(100000 + Math.random() * 900000);
                                    if ($('#TipoUbicacionRD').val() === "Origen") {
                                        clave = "OR" + randomClave;
                                    } else {
                                        clave = "DE" + randomClave;
                                    }
                                    var IDubi = $('#Ubicacion_IDUbicacion').val(clave);


                                }

                                $('#Ubicacion_RfcRemitenteDestinatario').val(carta.RFCRemitenteDestinatario);
                                $('#Ubicacion_NombreRemitenteDestinatario').val(carta.NombreRemitenteDestinatario);


                                     //Si es de tipo Extranjero
                                    $('#Ubicacion_NumRegIdTrib').val(carta.NumRegIdTrib);
                                    $('#Ubicacion_ResidenciaFiscal').val(carta.ResidenciaFiscal);

                                    $('#Ubicacion_FechaHoraSalidaLlegada').val(carta.FechaHoraSalidaLlegada);
                                    $('#DistanciaRO').val(carta.DistanciaRecorrida);


                                //Seccion Domicilio
                                $('#Ubicacion_Domicilio_Calle').val(carta.Domicilio.Calle);
                                $('#Ubicacion_Domicilio_NumeroExterior').val(carta.Domicilio.NumeroExterior);
                                $('#Ubicacion_Domicilio_NumeroInterior').val(carta.Domicilio.NumeroExterior);
                                $('#Ubicacion_Domicilio_Referencia').val(carta.Domicilio.Referencia);
                                $('#Ubicacion_Domicilio_Paises').val(carta.Domicilio.Pais);
                                $('#Ubicacion_Domicilio_Paises').trigger('change');
                                $('#Ubicacion_Domicilio_ddlEstados option:selected').val(carta.Domicilio.Estado);
                                $('#Ubicacion_Domicilio_ddlEstados option:selected').trigger('change');
                                $('#Ubicacion_Domicilio_Municipio').val(carta.Domicilio.Municipio);
                                $('#Ubicacion_Domicilio_Municipio').trigger('change');
                                $('#Ubicacion_Domicilio_Localidad').val(carta.Domicilio.Localidad);
                                $('#Ubicacion_Domicilio_CodigoPostal').val(carta.Domicilio.CodigoPostal)
                                $('#Ubicacion_Domicilio_Colonia').val(carta.Domicilio.Colonia);


                                //Validacion Para Ocultar Campos al Ser Tipo Transporte = 01

                                if (permisoValue) {

                                    $('#DivEstacionMaritimo').hide();
                                    $('#DivEstacionAereo').hide();
                                    $('#DivEstacionFerroviario').hide();
                                    $('#DivNumEstacion').hide();
                                    $('#DivNavegacionTrafico').hide();
                                    $('#TipoEs').hide();

                                }

                                //Agregar a Detalles
                                $('#agregarDetalleUbicacion').trigger('click')

                                $('#TipoUbicacionRD').val("Origen");

                            });

                            $.each(response.CartaPorte.Mercancias.Mercancia, function (index, mer) {
                                $('#Mercancias_Mercancia_ClaveProdServCP').val(mer.BienesTransp);
                                $('#Mercancias_Mercancia_Descripcion').val(mer.Descripcion);
                                $('#Mercancias_Mercancia_Cantidad').val(mer.Cantidad);
                                $('#Mercancias_Mercancia_ClavesUnidad').val(mer.ClaveUnidad);
                                $('#Mercancias_Mercancia_Unidad').val(mer.Unidad);
                                $('#Mercancias_Mercancia_PesoEnKg').val(mer.PesoEnKg);
                                $('#agregarDetalleMercancia').trigger('click');


                            });

                            $.each(response.CartaPorte.Mercancias.Autotransporte.Remolques, function (index, remolque) {
                                var SubTipoRem = '';
                                switch (remolque.SubTipoRem) {

                                    case 0: SubTipoRem = 'CTR001'; break;
                                    case 1: SubTipoRem = 'CTR002'; break;
                                    case 2: SubTipoRem = 'CTR003'; break;
                                    case 3: SubTipoRem = 'CTR004'; break;
                                    case 4: SubTipoRem = 'CTR005'; break;
                                    case 5: SubTipoRem = 'CTR006'; break;
                                    case 6: SubTipoRem = 'CTR007'; break;
                                    case 7: SubTipoRem = 'CTR008'; break;
                                    case 8: SubTipoRem = 'CTR009'; break;
                                    case 9: SubTipoRem = 'CTR010'; break;
                                    case 10: SubTipoRem = 'CTR011'; break;
                                    case 11: SubTipoRem = 'CTR012'; break;
                                    case 12: SubTipoRem = 'CTR013'; break;
                                    case 13: SubTipoRem = 'CTR014'; break;
                                    case 14: SubTipoRem = 'CTR015'; break;
                                    case 15: SubTipoRem = 'CTR016'; break;
                                    case 16: SubTipoRem = 'CTR017'; break;
                                    case 17: SubTipoRem = 'CTR018'; break;
                                    case 18: SubTipoRem = 'CTR019'; break;
                                    case 19: SubTipoRem = 'CTR020'; break;
                                    case 20: SubTipoRem = 'CTR021'; break;
                                    case 21: SubTipoRem = 'CTR022'; break;
                                    case 22: SubTipoRem = 'CTR023'; break;
                                    case 23: SubTipoRem = 'CTR024'; break;
                                    case 24: SubTipoRem = 'CTR025'; break;
                                    case 25: SubTipoRem = 'CTR026'; break;
                                    case 26: SubTipoRem = 'CTR027'; break;
                                    case 27: SubTipoRem = 'CTR028'; break;
                                    case 28: SubTipoRem = 'CTR029'; break;
                                    case 29: SubTipoRem = 'CTR030'; break;
                                    case 30: SubTipoRem = 'CTR031'; break;
                                    case 31: SubTipoRem = 'CTR032'; break;
                                    // Agrega más casos según los valores del enum
                                    default:
                                        SubTipoRem = 'Valor desconocido';
                                        break;
                                }

                                // Asignar los valores a los campos
                                $('#Mercancias_AutoTransporte_Remolque_SubTipoRem_Id').val(SubTipoRem);
                                $('#Mercancias_AutoTransporte_Remolque_Placa').val(remolque.Placa);
                                $('#agregarDetalleRemolqueAuTransp').trigger('click');

                            });

                            $.each(response.CartaPorte.FiguraTransporte, function (index, figura) {



                                $.each(response.CartaPorte.FiguraTransporte, function (index, figura) {

                                    $('#TipoFiguraTransporte').val(figura.TipoFigura);
                                    $('#TiposFigura_RFCFigura').val(figura.RFCFigura);
                                    $('#TiposFigura_NumLicencia').val(figura.NumLicencia);
                                    $('#TiposFigura_NombreFigura').val(figura.NombreFigura);

                                    $('#agregarDetalleFTransporte').trigger('click');












                                    //Cerramos el Modal al Cargar Todos los Datos
                                    $('#kt_modal_3').modal('hide');


                                    //Bloqueamos el boton despues de cargar el Xml
                                    //El usuario se vera forzado a recargar la pagina

                                    // Obtener el botón por su ID
                                    const cargarXmlButton = document.getElementById('cargarXmlButton');

                                    // Función que se ejecuta cuando el usuario selecciona un archivo
                                    function handleFileSelect(event) {
                                        // Deshabilitar el botón después de seleccionar un archivo
                                        cargarXmlButton.disabled = true;
                                    }

                                    // Asociar el evento change al input de tipo file
                                    const fileInput = document.querySelector('input[type="file"]');
                                    fileInput.addEventListener('change', handleFileSelect);



                                    ///*Despues de Asignar valores dejo Los campos en Blanco para evitar detalles*/
                                    //$('#TipoUbicacionRD').val();
                                    //$('#Ubicacion_IDUbicacion').val();
                                    //$('#Ubicacion_RfcRemitenteDestinatario').val();
                                    //$('#Ubicacion_NombreRemitenteDestinatario').val();
                                    //$('#Ubicacion_FechaHoraSalidaLlegada').val();
                                    //$('#DistanciaRO').val();
                                    //$('#Ubicacion_Domicilio_Calle').val();
                                    //$('#Ubicacion_Domicilio_NumeroExterior').val();
                                    //$('#Ubicacion_Domicilio_NumeroInterior').val();
                                    //$('#Ubicacion_Domicilio_Referencia').val();
                                    //$('#Ubicacion_Domicilio_Paises').val();
                                    //$('#Ubicacion_Domicilio_ddlEstados option:selected').val();
                                    //$('#Ubicacion_Domicilio_Municipio').val();
                                    //$('#Ubicacion_Domicilio_Localidad').val();
                                    //$('#Ubicacion_Domicilio_CodigoPostal').val();
                                    //$('#Ubicacion_Domicilio_Colonia').val();
                                });
                                agregarcomplementofigura(
                                    figura.TipoFigura,
                                    figura.RFCFigura,
                                    figura.NumLicencia,
                                    figura.NombreFigura

                                );
                            });
                            $.each(response.CartaPorte.Mercancias.Autotransporte.Remolques, function (index, remolque) {


                                agregarcomplementoRemolque(
                                    remolque.Placa,
                                    SubTipoRem
                                );
                            });

                            agregarcomplementoMercancia(
                                mer.BienesTransp,
                                mer.Descripcion,
                                mer.Cantidad,
                                mer.ClaveUnidad,
                                mer.PesoEnKg
                            );
                        });

                        agregarcomplementoCarta(
                            carta.TipoUbicacion,
                            carta.IDUbicacion,
                            carta.RFCRemitenteDestinatario,
                            carta.NombreRemitenteDestinatario,
                            carta.FechaHoraSalidaLlegada,
                            //Domicilio
                            carta.Domicilio.Calle,
                        );

                    });


                },
                error: function (jqxhr, textStatus, error) {
                    alert('Ocurrió un error al cargar el archivo XML');
                },
            });
        });
    });


</script>


